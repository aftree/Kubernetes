<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ğŸ˜Š - æœåŠ¡ã€è´Ÿè½½å‡è¡¡å’Œè”ç½‘ on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</title>
    <link>https://lijun.in/concepts/services-networking/</link>
    <description>Recent content in ğŸ˜Š - æœåŠ¡ã€è´Ÿè½½å‡è¡¡å’Œè”ç½‘ on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    
	<atom:link href="https://lijun.in/concepts/services-networking/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Endpoint Slices</title>
      <link>https://lijun.in/concepts/services-networking/endpoint-slices/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/endpoint-slices/</guid>
      <description>feature-state for_k8s_version=&amp;quot;v1.17&amp;rdquo; state=&amp;quot;beta&amp;rdquo;
Endpoint Slices æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥è·Ÿè¸ª Kubernetes é›†ç¾¤ä¸­çš„ç½‘ç»œç«¯ç‚¹ï¼ˆnetwork endpointsï¼‰ã€‚å®ƒä»¬ä¸º Endpoints æä¾›äº†ä¸€ç§å¯ä¼¸ç¼©å’Œå¯æ‹“å±•çš„æ›¿ä»£æ–¹æ¡ˆã€‚
Endpoint Slice èµ„æº åœ¨ Kubernetes ä¸­ï¼ŒEndpointSlice åŒ…å«å¯¹ä¸€ç»„ç½‘ç»œç«¯ç‚¹çš„å¼•ç”¨ã€‚æŒ‡å®šé€‰æ‹©å™¨åï¼ŒEndpointSlice æ§åˆ¶å™¨ä¼šè‡ªåŠ¨ä¸º Kubernetes æœåŠ¡åˆ›å»º EndpointSliceã€‚è¿™äº› EndpointSlice å°†åŒ…å«å¯¹ä¸æœåŠ¡é€‰æ‹©å™¨åŒ¹é…çš„æ‰€æœ‰ Pod çš„å¼•ç”¨ã€‚EndpointSlice é€šè¿‡å”¯ä¸€çš„æœåŠ¡å’Œç«¯å£ç»„åˆå°†ç½‘ç»œç«¯ç‚¹ç»„ç»‡åœ¨ä¸€èµ·ã€‚
ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ KubernetesæœåŠ¡ example çš„ç¤ºä¾‹ EndpointSlice èµ„æºã€‚
apiVersion: discovery.k8s.io/v1beta1 kind: EndpointSlice metadata: name: example-abc labels: kubernetes.io/service-name: example addressType: IPv4 ports: - name: http protocol: TCP port: 80 endpoints: - addresses: - &amp;#34;10.1.2.3&amp;#34; conditions: ready: true hostname: pod-1 topology: kubernetes.io/hostname: node-1 topology.kubernetes.io/zone: us-west2-a é»˜è®¤æƒ…å†µä¸‹ï¼Œç”± EndpointSlice æ§åˆ¶å™¨ç®¡ç†çš„ Endpoint Slice å°†æœ‰ä¸è¶…è¿‡ 100 ä¸ª endpointsã€‚ä½äºæ­¤æ¯”ä¾‹æ—¶ï¼ŒEndpoint Slices åº”ä¸ Endpoints å’ŒæœåŠ¡è¿›è¡Œ 1ï¼š1 æ˜ å°„ï¼Œå¹¶å…·æœ‰ç›¸ä¼¼çš„æ€§èƒ½ã€‚</description>
    </item>
    
    <item>
      <title>Service æ‹“æ‰‘</title>
      <link>https://lijun.in/concepts/services-networking/service-topology/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/service-topology/</guid>
      <description>feature-state for_k8s_version=&amp;quot;v1.17&amp;rdquo; state=&amp;quot;alpha&amp;rdquo; &amp;gt;}}
Service æ‹“æ‰‘å¯ä»¥è®©ä¸€ä¸ªæœåŠ¡åŸºäºé›†ç¾¤çš„ Node æ‹“æ‰‘è¿›è¡Œæµé‡è·¯ç”±ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæœåŠ¡å¯ä»¥æŒ‡å®šæµé‡æ˜¯è¢«ä¼˜å…ˆè·¯ç”±åˆ°ä¸€ä¸ªå’Œå®¢æˆ·ç«¯åœ¨åŒä¸€ä¸ª Node æˆ–è€…åœ¨åŒä¸€å¯ç”¨åŒºåŸŸçš„ç«¯ç‚¹ã€‚
ä»‹ç» é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘å¾€ ClusterIP æˆ–è€… NodePort æœåŠ¡çš„æµé‡å¯èƒ½ä¼šè¢«è·¯ç”±åˆ°ä»»æ„ä¸€ä¸ªæœåŠ¡åç«¯çš„åœ°å€ä¸Šã€‚ä» Kubernetes 1.7 å¼€å§‹ï¼Œå¯ä»¥å°†â€œå¤–éƒ¨â€æµé‡è·¯ç”±åˆ°èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ pod ä¸Šï¼Œä½†ä¸æ”¯æŒ ClusterIP æœåŠ¡ï¼Œæ›´å¤æ‚çš„æ‹“æ‰‘ â€” æ¯”å¦‚åˆ†åŒºè·¯ç”± â€” ä¹Ÿè¿˜ä¸æ”¯æŒã€‚é€šè¿‡å…è®¸ Service åˆ›å»ºè€…æ ¹æ®æº Node å’Œç›®çš„ Node çš„æ ‡ç­¾æ¥å®šä¹‰æµé‡è·¯ç”±ç­–ç•¥ï¼ŒService æ‹“æ‰‘ç‰¹æ€§å®ç°äº†æœåŠ¡æµé‡çš„è·¯ç”±ã€‚
é€šè¿‡å¯¹æº Node å’Œç›®çš„ Node æ ‡ç­¾çš„åŒ¹é…ï¼Œè¿è¥è€…å¯ä»¥ä½¿ç”¨ä»»ä½•ç¬¦åˆè¿è¥è€…è¦æ±‚çš„åº¦é‡å€¼æ¥æŒ‡å®šå½¼æ­¤â€œè¾ƒè¿‘â€å’Œâ€œè¾ƒè¿œâ€çš„èŠ‚ç‚¹ç»„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºåœ¨å…¬æœ‰äº‘ä¸Šçš„è¿è¥è€…æ¥è¯´ï¼Œæ›´åå‘äºæŠŠæµé‡æ§åˆ¶åœ¨åŒä¸€åŒºåŸŸå†…ï¼Œå› ä¸ºåŒºåŸŸé—´çš„æµé‡æ˜¯æœ‰è´¹ç”¨æˆæœ¬çš„ï¼Œè€ŒåŒºåŸŸå†…çš„æµé‡æ²¡æœ‰ã€‚å…¶å®ƒå¸¸ç”¨éœ€æ±‚è¿˜åŒ…æ‹¬æŠŠæµé‡è·¯ç”±åˆ°ç”± DaemonSet ç®¡ç†çš„æœ¬åœ° Pod ä¸Šï¼Œæˆ–è€…æŠŠä¿æŒæµé‡åœ¨è¿æ¥åŒä¸€æœºæ¶äº¤æ¢æœºçš„ Node ä¸Šï¼Œä»¥è·å¾—ä½å»¶æ—¶ã€‚
å‰ææ¡ä»¶ ä¸ºäº†å¯ç”¨æ‹“æ‰‘æ„ŸçŸ¥æœåŠ¡è·¯ç”±åŠŸèƒ½ï¼Œå¿…é¡»è¦æ»¡è¶³ä»¥ä¸‹ä¸€äº›å‰ææ¡ä»¶ï¼š
 Kubernetes çš„ç‰ˆæœ¬ä¸ä½äº 1.17 Kube-proxy è¿è¡Œåœ¨ iptables æ¨¡å¼æˆ–è€… IPVS æ¨¡å¼ å¯ç”¨ ç«¯ç‚¹åˆ‡ç‰‡åŠŸèƒ½  å¯ç”¨ Service æ‹“æ‰‘ è¦å¯ç”¨ Service æ‹“æ‰‘ï¼Œå°±è¦ç»™ kube-apiserver å’Œ kube-proxy å¯ç”¨ ServiceTopology åŠŸèƒ½ï¼š</description>
    </item>
    
    <item>
      <title>Services</title>
      <link>https://lijun.in/concepts/services-networking/service/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/service/</guid>
      <description>apiVersion: v1 kind: Service # string Required èµ„æºç±»å‹ metadata: # Object Required å…ƒæ•°æ® name: string # string Required Serviceåç§° namespace: string # string Required å‘½åç©ºé—´ï¼Œé»˜è®¤default labels: # list Required è‡ªå®šä¹‰æ ‡ç­¾å±æ€§åˆ—è¡¨ - name: string annotations: # list Required è‡ªå®šä¹‰æ³¨è§£å±æ€§åˆ—è¡¨ - name: string spec: # Object Required è¯¦ç»†æè¿° selector: [] # list Required Label Selectoré…ç½®ï¼Œå°†é€‰æ‹©å…·æœ‰æŒ‡å®šLabelæ ‡ç­¾çš„Podä½œä¸ºç®¡ç†èŒƒå›´ type: string # string Required Serviceçš„ç±»å‹ï¼ŒæŒ‡å®šServiceçš„è®¿é—®æ–¹å¼ï¼Œé»˜è®¤ä¸ºClusterIP # ClusterIPï¼šè™šæ‹Ÿçš„æœåŠ¡IPåœ°å€ï¼Œæ”¹åœ°å€ç”¨äºKubernetesé›†ç¾¤å†…éƒ¨çš„Podè®¿é—®ï¼Œåœ¨Nodeä¸Škube-proxyé€šè¿‡è®¾ç½®iptablesè§„åˆ™è¿›è¡Œè½¬å‘ # NodePort: ä½¿ç”¨å®¿ä¸»æœºçš„ç«¯å£ï¼Œä½¿èƒ½å¤Ÿè®¿é—®ä¸ªNodeçš„å¤–éƒ¨å®¢æˆ·ç«¯é€šè¿‡Nodeçš„IPåœ°å€å’Œç«¯å£å·å°±èƒ½è®¿é—®æœåŠ¡ # LoadBalancer: ä½¿ç”¨å¤–æ¥è´Ÿè½½å‡è¡¡å®Œæˆåˆ°æœåŠ¡çš„è´Ÿè½½åˆ†å‘ï¼Œéœ€è¦åœ¨spec.status.loadBalancerå­—æ®µæŒ‡å®šå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨çš„IPåœ°å€ï¼Œ # å¹¶åŒæ—¶å®šä¹‰nodePortå’ŒclusterIPï¼Œç”¨äºå…¬æœ‰äº‘ç¯å¢ƒ clusterIP: string # string è™šæ‹ŸæœåŠ¡IPåœ°å€ï¼Œå½“type=ClusterIPæ—¶ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼›å½“type=LoaderBalanceréœ€è¦æŒ‡å®š sessionAffinity: string # string æ˜¯å¦æ”¯æŒSessionï¼Œå¯é€‰å€¼ä¸ºClientIPï¼Œé»˜è®¤ä¸ºç©º # ClientIP: è¡¨ç¤ºå°†åŒä¸€ä¸ªå®¢æˆ·ç«¯ï¼ˆæ ¹æ®IPåœ°å€å†³å®šï¼‰çš„è®¿é—®è¯·æ±‚éƒ½è½¬å‘åˆ°åŒä¸€ä¸ªåç«¯Pod ports: # list éœ€è¦æš´éœ²çš„ç«¯å£åˆ—è¡¨ - name: string # ç«¯å£åç§° protocol: string # ç«¯å£åè®® æ”¯æŒtcpå’Œudpï¼Œé»˜è®¤ä¸ºtcp port: int # æœåŠ¡ç›‘å¬çš„ç«¯å£å· targetPort: int # éœ€è¦è½¬å‘åˆ°åç«¯Podçš„ç«¯å£å· nodePort: int # å½“spec.</description>
    </item>
    
    <item>
      <title>Pod ä¸ Service çš„ DNS</title>
      <link>https://lijun.in/concepts/services-networking/dns-pod-service/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/dns-pod-service/</guid>
      <description>è¯¥é¡µé¢æ¦‚è¿°äº†Kuberneteså¯¹DNSçš„æ”¯æŒã€‚
ä»‹ç» Kubernetes DNS åœ¨ç¾¤é›†ä¸Šè°ƒåº¦ DNS Pod å’ŒæœåŠ¡ï¼Œå¹¶é…ç½® kubelet ä»¥å‘ŠçŸ¥å„ä¸ªå®¹å™¨ä½¿ç”¨ DNS æœåŠ¡çš„ IP æ¥è§£æ DNS åç§°ã€‚
æ€æ ·è·å– DNS åå­—? åœ¨é›†ç¾¤ä¸­å®šä¹‰çš„æ¯ä¸ª Serviceï¼ˆåŒ…æ‹¬ DNS æœåŠ¡å™¨è‡ªèº«ï¼‰éƒ½ä¼šè¢«æŒ‡æ´¾ä¸€ä¸ª DNS åç§°ã€‚ é»˜è®¤ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯ Pod çš„ DNS æœç´¢åˆ—è¡¨å°†åŒ…å«è¯¥ Pod è‡ªå·±çš„ Namespace å’Œé›†ç¾¤é»˜è®¤åŸŸã€‚ é€šè¿‡å¦‚ä¸‹ç¤ºä¾‹å¯ä»¥å¾ˆå¥½åœ°è¯´æ˜ï¼š
å‡è®¾åœ¨ Kubernetes é›†ç¾¤çš„ Namespace bar ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªService fooã€‚ è¿è¡Œåœ¨Namespace bar ä¸­çš„ä¸€ä¸ª Podï¼Œå¯ä»¥ç®€å•åœ°é€šè¿‡ DNS æŸ¥è¯¢ foo æ¥æ‰¾åˆ°è¯¥ Serviceã€‚ è¿è¡Œåœ¨ Namespace quux ä¸­çš„ä¸€ä¸ª Pod å¯ä»¥é€šè¿‡ DNS æŸ¥è¯¢ foo.bar æ‰¾åˆ°è¯¥ Serviceã€‚
ä»¥ä¸‹å„èŠ‚è¯¦ç»†ä»‹ç»äº†å—æ”¯æŒçš„è®°å½•ç±»å‹å’Œæ”¯æŒçš„å¸ƒå±€ã€‚ å…¶ä¸­ä»£ç éƒ¨åˆ†çš„å¸ƒå±€ï¼Œåç§°æˆ–æŸ¥è¯¢å‘½ä»¤å‡è¢«è§†ä¸ºå®ç°ç»†èŠ‚ï¼Œå¦‚æœ‰æ›´æ”¹ï¼Œæ•ä¸å¦è¡Œé€šçŸ¥ã€‚ æœ‰å…³æœ€æ–°è§„èŒƒè¯·æŸ¥çœ‹ Kubernetes åŸºäº DNS çš„æœåŠ¡å‘ç°.
æ”¯æŒçš„ DNS æ¨¡å¼ ä¸‹é¢å„æ®µè¯¦ç»†è¯´æ˜æ”¯æŒçš„è®°å½•ç±»å‹å’Œå¸ƒå±€ã€‚ å¦‚æœä»»ä½•å…¶å®ƒçš„å¸ƒå±€ã€åç§°æˆ–æŸ¥è¯¢ï¼Œç¢°å·§ä¹Ÿèƒ½å¤Ÿä½¿ç”¨ï¼Œè¿™å°±éœ€è¦ç ”ç©¶ä¸‹å®ƒä»¬çš„å®ç°ç»†èŠ‚ï¼Œä»¥å…åç»­ä¿®æ”¹å®ƒä»¬åˆä¸èƒ½ä½¿ç”¨äº†ã€‚</description>
    </item>
    
    <item>
      <title>åº”ç”¨è¿æ¥åˆ° Service</title>
      <link>https://lijun.in/concepts/services-networking/connect-applications-service/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/connect-applications-service/</guid>
      <description>Kubernetes è¿æ¥å®¹å™¨æ¨¡å‹ æ—¢ç„¶æœ‰äº†ä¸€ä¸ªæŒç»­è¿è¡Œã€å¯å¤åˆ¶çš„åº”ç”¨ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå°†å®ƒæš´éœ²åˆ°ç½‘ç»œä¸Šã€‚ åœ¨è®¨è®º Kubernetes ç½‘ç»œè¿æ¥çš„æ–¹å¼ä¹‹å‰ï¼Œéå¸¸å€¼å¾—ä¸ Docker ä¸­ â€œæ­£å¸¸â€ æ–¹å¼çš„ç½‘ç»œè¿›è¡Œå¯¹æ¯”ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker ä½¿ç”¨ç§æœ‰ä¸»æœºç½‘ç»œè¿æ¥ï¼Œåªèƒ½ä¸åŒåœ¨ä¸€å°æœºå™¨ä¸Šçš„å®¹å™¨è¿›è¡Œé€šä¿¡ã€‚ ä¸ºäº†å®ç°å®¹å™¨çš„è·¨èŠ‚ç‚¹é€šä¿¡ï¼Œå¿…é¡»åœ¨æœºå™¨è‡ªå·±çš„ IP ä¸Šä¸ºè¿™äº›å®¹å™¨åˆ†é…ç«¯å£ï¼Œä¸ºå®¹å™¨è¿›è¡Œç«¯å£è½¬å‘æˆ–è€…ä»£ç†ã€‚
å¤šä¸ªå¼€å‘äººå‘˜ä¹‹é—´åè°ƒç«¯å£çš„ä½¿ç”¨å¾ˆéš¾åšåˆ°è§„æ¨¡åŒ–ï¼Œé‚£äº›éš¾ä»¥æ§åˆ¶çš„é›†ç¾¤çº§åˆ«çš„é—®é¢˜ï¼Œéƒ½ä¼šäº¤ç”±ç”¨æˆ·è‡ªå·±å»å¤„ç†ã€‚ Kubernetes å‡è®¾ Pod å¯ä¸å…¶å®ƒ Pod é€šä¿¡ï¼Œä¸ç®¡å®ƒä»¬åœ¨å“ªä¸ªä¸»æœºä¸Šã€‚ æˆ‘ä»¬ç»™ Pod åˆ†é…å±äºè‡ªå·±çš„é›†ç¾¤ç§æœ‰ IP åœ°å€ï¼Œæ‰€ä»¥æ²¡å¿…è¦åœ¨ Pod æˆ–æ˜ å°„åˆ°çš„å®¹å™¨çš„ç«¯å£å’Œä¸»æœºç«¯å£ä¹‹é—´æ˜¾å¼åœ°åˆ›å»ºè¿æ¥ã€‚ è¿™è¡¨æ˜äº†åœ¨ Pod å†…çš„å®¹å™¨éƒ½èƒ½å¤Ÿè¿æ¥åˆ°æœ¬åœ°çš„æ¯ä¸ªç«¯å£ï¼Œé›†ç¾¤ä¸­çš„æ‰€æœ‰ Pod ä¸éœ€è¦é€šè¿‡ NAT è½¬æ¢å°±èƒ½å¤Ÿäº’ç›¸çœ‹åˆ°ã€‚ æ–‡æ¡£çš„å‰©ä½™éƒ¨åˆ†å°†è¯¦è¿°å¦‚ä½•åœ¨ä¸€ä¸ªç½‘ç»œæ¨¡å‹ä¹‹ä¸Šè¿è¡Œå¯é çš„æœåŠ¡ã€‚
è¯¥æŒ‡å—ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ Nginx server æ¥æ¼”ç¤ºå¹¶è¯æ˜è°ˆåˆ°çš„æ¦‚å¿µã€‚åŒæ ·çš„åŸåˆ™ä¹Ÿä½“ç°åœ¨ä¸€ä¸ªæ›´åŠ å®Œæ•´çš„ Jenkins CI åº”ç”¨ ä¸­ã€‚
åœ¨é›†ç¾¤ä¸­æš´éœ² Pod æˆ‘ä»¬åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­å·²ç»åšè¿‡ï¼Œç„¶è€Œå†è®©æˆ‘é‡è¯•ä¸€æ¬¡ï¼Œè¿™æ¬¡èšç„¦åœ¨ç½‘ç»œè¿æ¥çš„è§†è§’ã€‚ åˆ›å»ºä¸€ä¸ª Nginx Podï¼ŒæŒ‡ç¤ºå®ƒå…·æœ‰ä¸€ä¸ªå®¹å™¨ç«¯å£çš„è¯´æ˜ï¼š
codenew file=&amp;quot;service/networking/run-my-nginx.yaml&amp;rdquo; &amp;gt;}}
è¿™ä½¿å¾—å¯ä»¥ä»é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹æ¥è®¿é—®å®ƒã€‚æ£€æŸ¥èŠ‚ç‚¹ï¼Œè¯¥ Pod æ­£åœ¨è¿è¡Œï¼š
kubectl apply -f ./run-my-nginx.yaml kubectl get pods -l run=my-nginx -o wide NAME READY STATUS RESTARTS AGE IP NODE my-nginx-3800858182-jr4a2 1/1 Running 0 13s 10.</description>
    </item>
    
    <item>
      <title>Ingress</title>
      <link>https://lijun.in/concepts/services-networking/ingress/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/ingress/</guid>
      <description>feature-state for_k8s_version=&amp;quot;v1.1&amp;rdquo; state=&amp;quot;beta&amp;rdquo; &amp;gt;}} glossary_definition term_id=&amp;quot;ingress&amp;rdquo; length=&amp;quot;all&amp;rdquo; &amp;gt;}}
 èŠ‚ç‚¹ï¼ˆNodeï¼‰: Kubernetes é›†ç¾¤ä¸­å…¶ä¸­ä¸€å°å·¥ä½œæœºå™¨ï¼Œæ˜¯é›†ç¾¤çš„ä¸€éƒ¨åˆ†ã€‚ é›†ç¾¤ï¼ˆClusterï¼‰: ä¸€ç»„è¿è¡Œç¨‹åºï¼ˆè¿™äº›ç¨‹åºæ˜¯å®¹å™¨åŒ–çš„ï¼Œè¢« Kubernetes ç®¡ç†çš„ï¼‰çš„èŠ‚ç‚¹ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå’Œåœ¨å¤§å¤šæ•°å¸¸è§çš„Kuberneteséƒ¨ç½²æ–¹æ¡ˆï¼Œé›†ç¾¤ä¸­çš„èŠ‚ç‚¹éƒ½ä¸ä¼šæ˜¯å…¬å…±ç½‘ç»œã€‚ è¾¹ç¼˜è·¯ç”±å™¨ï¼ˆEdge routerï¼‰: åœ¨é›†ç¾¤ä¸­å¼ºåˆ¶æ€§æ‰§è¡Œé˜²ç«å¢™ç­–ç•¥çš„è·¯ç”±å™¨ï¼ˆrouterï¼‰ã€‚å¯ä»¥æ˜¯ç”±äº‘æä¾›å•†ç®¡ç†çš„ç½‘å…³ï¼Œä¹Ÿå¯ä»¥æ˜¯ç‰©ç†ç¡¬ä»¶ã€‚ é›†ç¾¤ç½‘ç»œï¼ˆCluster networkï¼‰: ä¸€ç»„é€»è¾‘æˆ–ç‰©ç†çš„é“¾æ¥ï¼Œæ ¹æ® Kubernetes ç½‘ç»œæ¨¡å‹ åœ¨é›†ç¾¤å†…å®ç°é€šä¿¡ã€‚ æœåŠ¡ï¼ˆServiceï¼‰ï¼šKubernetes Serviceæ ‡ç­¾é€‰æ‹©å™¨ï¼ˆselectorsï¼‰æ ‡è¯†çš„ä¸€ç»„ Podã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™å‡å®šæœåŠ¡åªå…·æœ‰åœ¨é›†ç¾¤ç½‘ç»œä¸­å¯è·¯ç”±çš„è™šæ‹Ÿ IPã€‚  å¯ä»¥å°† Ingress é…ç½®ä¸ºæä¾›æœåŠ¡å¤–éƒ¨å¯è®¿é—®çš„ URLã€è´Ÿè½½å‡è¡¡æµé‡ã€ç»ˆæ­¢ SSL / TLSï¼Œä»¥åŠæä¾›åŸºäºåç§°çš„è™šæ‹Ÿä¸»æœºã€‚Ingress æ§åˆ¶å™¨ é€šå¸¸è´Ÿè´£é€šè¿‡è´Ÿè½½å‡è¡¡å™¨æ¥å®ç° Ingressï¼Œå°½ç®¡å®ƒä¹Ÿå¯ä»¥é…ç½®è¾¹ç¼˜è·¯ç”±å™¨æˆ–å…¶ä»–å‰ç«¯æ¥å¸®åŠ©å¤„ç†æµé‡ã€‚
Ingress ä¸ä¼šå…¬å¼€ä»»æ„ç«¯å£æˆ–åè®®ã€‚ å°† HTTP å’Œ HTTPS ä»¥å¤–çš„æœåŠ¡å…¬å¼€åˆ° Internet æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ Service.Type=NodePort æˆ–è€… Service.Type=LoadBalancer ç±»å‹çš„æœåŠ¡ã€‚
ç¯å¢ƒå‡†å¤‡ æ‚¨å¿…é¡»å…·æœ‰ ingress æ§åˆ¶å™¨ æ‰èƒ½æ»¡è¶³ Ingress çš„è¦æ±‚ã€‚ä»…åˆ›å»º Ingress èµ„æºæ— æ•ˆã€‚
æ‚¨å¯èƒ½éœ€è¦éƒ¨ç½² Ingress æ§åˆ¶å™¨ï¼Œä¾‹å¦‚ ingress-nginxã€‚æ‚¨å¯ä»¥ä»è®¸å¤šIngress æ§åˆ¶å™¨ ä¸­è¿›è¡Œé€‰æ‹©ã€‚
ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ Ingress æ§åˆ¶å™¨éƒ½åº”ç¬¦åˆå‚è€ƒè§„èŒƒã€‚ä½†å®é™…ä¸Šï¼Œä¸åŒçš„ Ingress æ§åˆ¶å™¨æ“ä½œç•¥æœ‰ä¸åŒã€‚</description>
    </item>
    
    <item>
      <title>Ingress æ§åˆ¶å™¨</title>
      <link>https://lijun.in/concepts/services-networking/ingress-controllers/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/ingress-controllers/</guid>
      <description>ä¸ºäº†è®© Ingress èµ„æºå·¥ä½œï¼Œé›†ç¾¤å¿…é¡»æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ Ingress æ§åˆ¶å™¨ã€‚
ä¸ä½œä¸º kube-controller-manager å¯æ‰§è¡Œæ–‡ä»¶çš„ä¸€éƒ¨åˆ†è¿è¡Œçš„å…¶ä»–ç±»å‹çš„æ§åˆ¶å™¨ä¸åŒï¼ŒIngress æ§åˆ¶å™¨ä¸æ˜¯éšé›†ç¾¤è‡ªåŠ¨å¯åŠ¨çš„ã€‚ åŸºäºæ­¤é¡µé¢ï¼Œæ‚¨å¯é€‰æ‹©æœ€é€‚åˆæ‚¨çš„é›†ç¾¤çš„ ingress æ§åˆ¶å™¨å®ç°ã€‚
Kubernetes ä½œä¸ºä¸€ä¸ªé¡¹ç›®ï¼Œç›®å‰æ”¯æŒå’Œç»´æŠ¤ GCE å’Œ nginx æ§åˆ¶å™¨ã€‚
å…¶ä»–æ§åˆ¶å™¨  [AKS åº”ç”¨ç¨‹åºç½‘å…³ Ingress æ§åˆ¶å™¨]ä½¿ç”¨ Azure åº”ç”¨ç¨‹åºç½‘å…³å¯ç”¨AKS é›†ç¾¤ ingressã€‚ Ambassador API ç½‘å…³ï¼Œ ä¸€ä¸ªåŸºäº Envoy çš„ ingress æ§åˆ¶å™¨ï¼Œæœ‰ç€æ¥è‡ªç¤¾åŒº çš„æ”¯æŒå’Œæ¥è‡ª Datawire çš„å•†ä¸š æ”¯æŒã€‚ AppsCode Inc. ä¸ºæœ€å¹¿æ³›ä½¿ç”¨çš„åŸºäº HAProxy çš„ ingress æ§åˆ¶å™¨ Voyager æä¾›æ”¯æŒå’Œç»´æŠ¤ã€‚ AWS ALB Ingress æ§åˆ¶å™¨é€šè¿‡ AWS åº”ç”¨ Load Balancer å¯ç”¨ ingressã€‚ Contour æ˜¯ä¸€ä¸ªåŸºäº Envoy çš„ ingress æ§åˆ¶å™¨ï¼Œå®ƒç”± VMware æä¾›å’Œæ”¯æŒã€‚ Citrix ä¸ºå…¶ç¡¬ä»¶ï¼ˆMPXï¼‰ï¼Œè™šæ‹ŸåŒ–ï¼ˆVPXï¼‰å’Œ å…è´¹å®¹å™¨åŒ– (CPX) ADC æä¾›äº†ä¸€ä¸ª Ingress æ§åˆ¶å™¨ï¼Œç”¨äºè£¸é‡‘å±å’Œäº‘éƒ¨ç½²ã€‚ F5 Networks ä¸º ç”¨äº Kubernetes çš„ F5 BIG-IP æ§åˆ¶å™¨æä¾›æ”¯æŒå’Œç»´æŠ¤ã€‚ Gloo æ˜¯ä¸€ä¸ªå¼€æºçš„åŸºäº Envoy çš„ ingress æ§åˆ¶å™¨ï¼Œå®ƒæä¾›äº† API ç½‘å…³åŠŸèƒ½ï¼Œæœ‰ç€æ¥è‡ª solo.</description>
    </item>
    
    <item>
      <title>ç½‘ç»œç­–ç•¥</title>
      <link>https://lijun.in/concepts/services-networking/network-policies/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/network-policies/</guid>
      <description>ç½‘ç»œç­–ç•¥ï¼ˆNetworkPolicyï¼‰æ˜¯ä¸€ç§å…³äº text=&amp;quot;Pod&amp;rdquo; term_id=&amp;quot;pod&amp;quot;&amp;gt;}} é—´åŠä¸å…¶ä»–ç½‘ç»œç«¯ç‚¹é—´æ‰€å…è®¸çš„é€šä¿¡è§„åˆ™çš„è§„èŒƒã€‚
NetworkPolicy èµ„æºä½¿ç”¨ text=&amp;quot;æ ‡ç­¾&amp;rdquo; term_id=&amp;quot;label&amp;quot;&amp;gt;}} é€‰æ‹© Podï¼Œå¹¶å®šä¹‰é€‰å®š Pod æ‰€å…è®¸çš„é€šä¿¡è§„åˆ™ã€‚
å‰æ ç½‘ç»œç­–ç•¥é€šè¿‡ç½‘ç»œæ’ä»¶æ¥å®ç°ã€‚è¦ä½¿ç”¨ç½‘ç»œç­–ç•¥ï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨æ”¯æŒ NetworkPolicy çš„ç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚åˆ›å»ºä¸€ä¸ªèµ„æºå¯¹è±¡ï¼Œè€Œæ²¡æœ‰æ§åˆ¶å™¨æ¥ä½¿å®ƒç”Ÿæ•ˆçš„è¯ï¼Œæ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ã€‚
éš”ç¦»å’Œééš”ç¦»çš„ Pod é»˜è®¤æƒ…å†µä¸‹ï¼ŒPod æ˜¯ééš”ç¦»çš„ï¼Œå®ƒä»¬æ¥å—ä»»ä½•æ¥æºçš„æµé‡ã€‚
Pod å¯ä»¥é€šè¿‡ç›¸å…³çš„ç½‘ç»œç­–ç•¥è¿›è¡Œéš”ç¦»ã€‚ä¸€æ—¦å‘½åç©ºé—´ä¸­æœ‰ç½‘ç»œç­–ç•¥é€‰æ‹©äº†ç‰¹å®šçš„ Podï¼Œè¯¥ Pod ä¼šæ‹’ç»ç½‘ç»œç­–ç•¥æ‰€ä¸å…è®¸çš„è¿æ¥ã€‚ (å‘½åç©ºé—´ä¸‹å…¶ä»–æœªè¢«ç½‘ç»œç­–ç•¥æ‰€é€‰æ‹©çš„ Pod ä¼šç»§ç»­æ¥æ”¶æ‰€æœ‰çš„æµé‡)
ç½‘ç»œç­–ç•¥ä¸ä¼šå†²çªï¼Œå®ƒä»¬æ˜¯é™„åŠ çš„ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªæˆ–å¤šä¸ªç­–ç•¥é€‰æ‹©äº†ä¸€ä¸ª Pod, åˆ™è¯¥ Pod å—é™äºè¿™äº›ç­–ç•¥çš„ ingress/egress è§„åˆ™çš„å¹¶é›†ã€‚å› æ­¤è¯„ä¼°çš„é¡ºåºå¹¶ä¸ä¼šå½±å“ç­–ç•¥çš„ç»“æœã€‚
NetworkPolicy èµ„æº æŸ¥çœ‹ [ç½‘ç»œç­–ç•¥](/docs/reference/generated/kubernetes-api/ param &amp;ldquo;version&amp;rdquo; &amp;gt;}}/#networkpolicy-v1-networking-k8s-io) æ¥äº†è§£å®Œæ•´çš„èµ„æºå®šä¹‰ã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ª NetworkPolicy çš„ç¤ºä¾‹:
apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: matchLabels: role: db policyTypes: - Ingress - Egress ingress: - from: - ipBlock: cidr: 172.</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ HostAliases å‘ Pod /etc/hosts æ–‡ä»¶æ·»åŠ æ¡ç›®</title>
      <link>https://lijun.in/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/</guid>
      <description>å½“ DNS é…ç½®ä»¥åŠå…¶å®ƒé€‰é¡¹ä¸åˆç†çš„æ—¶å€™ï¼Œé€šè¿‡å‘ Pod çš„ /etc/hosts æ–‡ä»¶ä¸­æ·»åŠ æ¡ç›®ï¼Œå¯ä»¥åœ¨ Pod çº§åˆ«è¦†ç›–å¯¹ä¸»æœºåçš„è§£æã€‚åœ¨ 1.7 ç‰ˆæœ¬ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ PodSpec çš„ HostAliases å­—æ®µæ¥æ·»åŠ è¿™äº›è‡ªå®šä¹‰çš„æ¡ç›®ã€‚
å»ºè®®é€šè¿‡ä½¿ç”¨ HostAliases æ¥è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºè¯¥æ–‡ä»¶ç”± Kubelet ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ Pod åˆ›å»º/é‡å¯è¿‡ç¨‹ä¸­è¢«é‡å†™ã€‚
é»˜è®¤ hosts æ–‡ä»¶å†…å®¹ è®©æˆ‘ä»¬ä»ä¸€ä¸ª Nginx Pod å¼€å§‹ï¼Œç»™è¯¥ Pod åˆ†é…ä¸€ä¸ª IPï¼š
kubectl run nginx --image nginx --generator=run-pod/v1 pod/nginx created æ£€æŸ¥Pod IPï¼š
kubectl get pods --output=wide NAME READY STATUS RESTARTS AGE IP NODE nginx 1/1 Running 0 13s 10.200.0.4 worker0 ä¸»æœºæ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š
kubectl exec nginx -- cat /etc/hosts # Kubernetes-managed hosts file.</description>
    </item>
    
    <item>
      <title>IPv4/IPv6 åŒåè®®æ ˆ</title>
      <link>https://lijun.in/concepts/services-networking/dual-stack/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/concepts/services-networking/dual-stack/</guid>
      <description>feature-state for_k8s_version=&amp;quot;v1.16&amp;rdquo; state=&amp;quot;alpha&amp;rdquo; &amp;gt;}}
IPv4/IPv6 åŒåè®®æ ˆèƒ½å¤Ÿå°† IPv4 å’Œ IPv6 åœ°å€åˆ†é…ç»™ text=&amp;quot;Pods&amp;rdquo; term_id=&amp;quot;pod&amp;rdquo; &amp;gt;}} å’Œ text=&amp;quot;Services&amp;rdquo; term_id=&amp;quot;service&amp;rdquo; &amp;gt;}}ã€‚
å¦‚æœä½ ä¸º Kubernetes é›†ç¾¤å¯ç”¨äº† IPv4/IPv6 åŒåè®®æ ˆç½‘ç»œï¼Œåˆ™è¯¥é›†ç¾¤å°†æ”¯æŒåŒæ—¶åˆ†é… IPv4 å’Œ IPv6 åœ°å€ã€‚
æ”¯æŒçš„åŠŸèƒ½ åœ¨ Kubernetes é›†ç¾¤ä¸Šå¯ç”¨ IPv4/IPv6 åŒåè®®æ ˆå¯æä¾›ä¸‹é¢çš„åŠŸèƒ½ï¼š
 åŒåè®®æ ˆ pod ç½‘ç»œ (æ¯ä¸ª pod åˆ†é…ä¸€ä¸ª IPv4 å’Œ IPv6 åœ°å€) IPv4 å’Œ IPv6 å¯ç”¨çš„æœåŠ¡ (æ¯ä¸ªæœåŠ¡å¿…é¡»æ˜¯ä¸€ä¸ªå•ç‹¬çš„åœ°å€æ—) Pod çš„é›†ç¾¤å¤–å‡ºå£é€šè¿‡ IPv4 å’Œ IPv6 è·¯ç”±  å…ˆå†³æ¡ä»¶ ä¸ºäº†ä½¿ç”¨ IPv4/IPv6 åŒæ ˆçš„ Kubernetes é›†ç¾¤ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹å…ˆå†³æ¡ä»¶ï¼š
 Kubernetes 1.16 ç‰ˆæœ¬åŠæ›´é«˜ç‰ˆæœ¬ æä¾›å•†æ”¯æŒåŒåè®®æ ˆç½‘ç»œï¼ˆäº‘æä¾›å•†æˆ–å…¶ä»–æä¾›å•†å¿…é¡»èƒ½å¤Ÿä¸º Kubernetes èŠ‚ç‚¹æä¾›å¯è·¯ç”±çš„ IPv4/IPv6 ç½‘ç»œæ¥å£ï¼‰ æ”¯æŒåŒåè®®æ ˆçš„ç½‘ç»œæ’ä»¶ï¼ˆå¦‚ Kubenet æˆ– Calicoï¼‰  å¯ç”¨ IPv4/IPv6 åŒåè®®æ ˆ è¦å¯ç”¨ IPv4/IPv6 åŒåè®®æ ˆï¼Œä¸ºé›†ç¾¤çš„ç›¸å…³ç»„ä»¶å¯ç”¨ IPv6DualStack ç‰¹æ€§é—¨æ§ï¼Œå¹¶ä¸”è®¾ç½®åŒåè®®æ ˆçš„é›†ç¾¤ç½‘ç»œåˆ†é…ï¼š</description>
    </item>
    
  </channel>
</rss>