<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ğŸ˜ - æ‰©å±• Kubernetes on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</title>
    <link>https://lijun.in/tasks/access-kubernetes-api/</link>
    <description>Recent content in ğŸ˜ - æ‰©å±• Kubernetes on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    
	<atom:link href="https://lijun.in/tasks/access-kubernetes-api/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>é…ç½®èšåˆå±‚</title>
      <link>https://lijun.in/tasks/access-kubernetes-api/configure-aggregation-layer/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/access-kubernetes-api/configure-aggregation-layer/</guid>
      <description>é…ç½® èšåˆå±‚ å…è®¸ Kubernetes apiserver ä½¿ç”¨å…¶å®ƒ API æ‰©å±•ï¼Œè¿™äº› API ä¸æ˜¯æ ¸å¿ƒ Kubernetes API çš„ä¸€éƒ¨åˆ†ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
. note &amp;gt;}}
è¦ä½¿èšåˆå±‚åœ¨æ‚¨çš„ç¯å¢ƒä¸­æ­£å¸¸å·¥ä½œä»¥æ”¯æŒä»£ç†æœåŠ¡å™¨å’Œæ‰©å±• apiserver ä¹‹é—´çš„ç›¸äº’ TLS èº«ä»½éªŒè¯ï¼Œéœ€è¦æ»¡è¶³ä¸€äº›è®¾ç½®è¦æ±‚ã€‚Kubernetes å’Œ kube-apiserver å…·æœ‰å¤šä¸ª CAï¼Œå› æ­¤è¯·ç¡®ä¿ä»£ç†æ˜¯ç”±èšåˆå±‚ CA ç­¾åçš„ï¼Œè€Œä¸æ˜¯ç”±ä¸» CA ç­¾åçš„ã€‚
. caution &amp;gt;}}
å¯¹ä¸åŒçš„å®¢æˆ·ç«¯ç±»å‹é‡å¤ä½¿ç”¨ç›¸åŒçš„ CA ä¼šå¯¹ç¾¤é›†çš„åŠŸèƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ CAé‡ç”¨å’Œå†²çªã€‚
. /caution &amp;gt;}} . /note &amp;gt;}}
è®¤è¯æµç¨‹ ä¸è‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼ˆCRDï¼‰ä¸åŒï¼Œé™¤æ ‡å‡†çš„ Kubernetes apiserver å¤–ï¼ŒAggregation API è¿˜æ¶‰åŠå¦ä¸€ä¸ªæœåŠ¡å™¨ï¼šæ‰©å±• apiserverã€‚Kubernetes apiserver å°†éœ€è¦ä¸æ‚¨çš„æ‰©å±• apiserver é€šä¿¡ï¼Œå¹¶ä¸”æ‚¨çš„æ‰©å±• apiserver ä¹Ÿéœ€è¦ä¸ Kubernetes apiserver é€šä¿¡ã€‚ä¸ºäº†ç¡®ä¿æ­¤é€šä¿¡çš„å®‰å…¨ï¼ŒKubernetes apiserver ä½¿ç”¨ x509 è¯ä¹¦å‘æ‰©å±• apiserver è®¤è¯ã€‚</description>
    </item>
    
    <item>
      <title>è®¾ç½®ä¸€ä¸ªæ‰©å±•çš„ API server</title>
      <link>https://lijun.in/tasks/access-kubernetes-api/setup-extension-api-server/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/access-kubernetes-api/setup-extension-api-server/</guid>
      <description>è®¾ç½®ä¸€ä¸ªæ‰©å±•çš„ API server æ¥ä½¿ç”¨èšåˆå±‚ä»¥è®© Kubernetes apiserver ä½¿ç”¨å…¶å®ƒ API è¿›è¡Œæ‰©å±•ï¼Œè¿™äº› API ä¸æ˜¯æ ¸å¿ƒ Kubernetes API çš„ä¸€éƒ¨åˆ†ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}}  æ‚¨éœ€è¦æ‹¥æœ‰ä¸€ä¸ªè¿è¡Œçš„ Kubernetes é›†ç¾¤ã€‚ æ‚¨å¿…é¡» é…ç½®èšåˆå±‚ å¹¶ä¸”å¯ç”¨ apiserver çš„ç›¸å…³å‚æ•°ã€‚  . heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
è®¾ç½®ä¸€ä¸ªæ‰©å±•çš„ api-server æ¥ä½¿ç”¨èšåˆå±‚ ä»¥ä¸‹æ­¥éª¤æè¿°å¦‚ä½• åœ¨ä¸€ä¸ªé«˜å±‚æ¬¡ è®¾ç½®ä¸€ä¸ªæ‰©å±•çš„ apiserverã€‚æ— è®ºæ‚¨ä½¿ç”¨çš„æ˜¯ YAML é…ç½®è¿˜æ˜¯ä½¿ç”¨ APIï¼Œè¿™äº›æ­¥éª¤éƒ½é€‚ç”¨ã€‚ç›®å‰æˆ‘ä»¬æ­£åœ¨å°è¯•åŒºåˆ†å‡ºä¸¤è€…çš„åŒºåˆ«ã€‚æœ‰å…³ä½¿ç”¨ YAML é…ç½®çš„å…·ä½“ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥åœ¨ Kubernetes åº“ä¸­æŸ¥çœ‹ sample-apiserverã€‚
æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç°æœ‰çš„ç¬¬ä¸‰æ–¹è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ apiserver-builderï¼Œå®ƒå°†ç”Ÿæˆæ¡†æ¶å¹¶è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ‰€æœ‰æ­¥éª¤ã€‚
 ç¡®ä¿å¯ç”¨äº† APIService APIï¼ˆæ£€æŸ¥ --runtime-configï¼‰ã€‚é»˜è®¤åº”è¯¥æ˜¯å¯ç”¨çš„ï¼Œé™¤éè¢«ç‰¹æ„å…³é—­äº†ã€‚ æ‚¨å¯èƒ½éœ€è¦åˆ¶å®šä¸€ä¸ª RBAC è§„åˆ™ï¼Œä»¥å…è®¸æ‚¨æ·»åŠ  APIService å¯¹è±¡ï¼Œæˆ–è®©æ‚¨çš„é›†ç¾¤ç®¡ç†å‘˜åˆ›å»ºä¸€ä¸ªã€‚ï¼ˆç”±äº API æ‰©å±•ä¼šå½±å“æ•´ä¸ªé›†ç¾¤ï¼Œå› æ­¤ä¸å»ºè®®åœ¨å®æ—¶é›†ç¾¤ä¸­å¯¹ API æ‰©å±•è¿›è¡Œæµ‹è¯•/å¼€å‘/è°ƒè¯•ï¼‰ åˆ›å»º Kubernetes å‘½åç©ºé—´ï¼Œæ‰©å±•çš„ api-service å°†è¿è¡Œåœ¨è¯¥å‘½åç©ºé—´ä¸­ã€‚ åˆ›å»ºï¼ˆæˆ–è·å–ï¼‰ç”¨æ¥ç­¾ç½²æœåŠ¡å™¨è¯ä¹¦çš„ CA è¯ä¹¦ï¼Œæ‰©å±• api-server ä¸­å°†ä½¿ç”¨è¯¥è¯ä¹¦åš HTTPS è¿æ¥ã€‚ ä¸º api-server åˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯çš„è¯ä¹¦ï¼ˆæˆ–ç§˜é’¥ï¼‰ä»¥ä½¿ç”¨ HTTPSã€‚è¿™ä¸ªè¯ä¹¦åº”è¯¥ç”±ä¸Šè¿°çš„ CA ç­¾ç½²ã€‚åŒæ—¶åº”è¯¥è¿˜è¦æœ‰ä¸€ä¸ª Kube DNS åç§°çš„ CNï¼Œè¿™æ˜¯ä» Kubernetes æœåŠ¡æ´¾ç”Ÿè€Œæ¥çš„ï¼Œæ ¼å¼ä¸º &amp;lt;service name&amp;gt;.</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ HTTP ä»£ç†è®¿é—® Kubernetes API</title>
      <link>https://lijun.in/tasks/access-kubernetes-api/http-proxy-access-api/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/access-kubernetes-api/http-proxy-access-api/</guid>
      <description>æœ¬æ–‡è¯´æ˜å¦‚ä½•ä½¿ç”¨ HTTP ä»£ç†è®¿é—® Kubernetes APIã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}}  . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}   å¦‚æœæ‚¨çš„é›†ç¾¤ä¸­è¿˜æ²¡æœ‰ä»»ä½•åº”ç”¨ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ª Hello World åº”ç”¨ï¼š  kubectl run node-hello --image=gcr.io/google-samples/node-hello:1.0 --port=8080 ä½¿ç”¨ kubectl å¯åŠ¨ä»£ç†æœåŠ¡å™¨ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ Kubernetes API æœåŠ¡å™¨çš„ä»£ç†ï¼š
kubectl proxy --port=8080  æ¢ç©¶ Kubernetes API å½“ä»£ç†æœåŠ¡å™¨åœ¨è¿è¡Œæ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ curlã€wget æˆ–è€…æµè§ˆå™¨è®¿é—® APIã€‚
è·å– API ç‰ˆæœ¬ï¼š
curl http://localhost:8080/api/ { &amp;quot;kind&amp;quot;: &amp;quot;APIVersions&amp;quot;, &amp;quot;versions&amp;quot;: [ &amp;quot;v1&amp;quot; ], &amp;quot;serverAddressByClientCIDRs&amp;quot;: [ { &amp;quot;clientCIDR&amp;quot;: &amp;quot;0.0.0.0/0&amp;quot;, &amp;quot;serverAddress&amp;quot;: &amp;quot;10.0.2.15:8443&amp;quot; } ] }  è·å– Pod åˆ—è¡¨ï¼š</description>
    </item>
    
  </channel>
</rss>