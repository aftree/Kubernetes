<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ğŸ˜ - é…ç½® Pods å’Œå®¹å™¨ on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</title>
    <link>https://lijun.in/tasks/configure-pod-container/</link>
    <description>Recent content in ğŸ˜ - é…ç½® Pods å’Œå®¹å™¨ on Hugo ä¸»é¢˜çš„ Learn æ–‡æ¡£</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    
	<atom:link href="https://lijun.in/tasks/configure-pod-container/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>ä¸ºå®¹å™¨å’Œ Pod åˆ†é…å†…å­˜èµ„æº</title>
      <link>https://lijun.in/tasks/configure-pod-container/assign-memory-resource/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/assign-memory-resource/</guid>
      <description>æ­¤é¡µé¢æ˜¾ç¤ºå¦‚ä½•å°†å†…å­˜ è¯·æ±‚ ï¼ˆrequestï¼‰å’Œå†…å­˜ é™åˆ¶ ï¼ˆlimitï¼‰åˆ†é…ç»™ä¸€ä¸ªå®¹å™¨ã€‚æˆ‘ä»¬ä¿éšœå®¹å™¨æ‹¥æœ‰å®ƒè¯·æ±‚æ•°é‡çš„å†…å­˜ï¼Œä½†ä¸å…è®¸ä½¿ç”¨è¶…è¿‡é™åˆ¶æ•°é‡çš„å†…å­˜ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
æ‚¨é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»æ‹¥æœ‰è‡³å°‘ 300 MiB çš„å†…å­˜ã€‚
è¯¥é¡µé¢ä¸Šçš„ä¸€äº›æ­¥éª¤è¦æ±‚æ‚¨åœ¨é›†ç¾¤ä¸­è¿è¡Œ metrics-server æœåŠ¡ã€‚å¦‚æœæ‚¨å·²ç»æœ‰åœ¨è¿è¡Œä¸­çš„ metrics-serverï¼Œåˆ™å¯ä»¥è·³è¿‡è¿™äº›æ­¥éª¤ã€‚
å¦‚æœæ‚¨è¿è¡Œçš„æ˜¯ Minikubeï¼Œå¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤å¯ç”¨ metrics-serverï¼š
minikube addons enable metrics-server è¦æŸ¥çœ‹ metrics-server æˆ–èµ„æºæŒ‡æ ‡ API (metrics.k8s.io) æ˜¯å¦å·²ç»è¿è¡Œï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
kubectl get apiservices å¦‚æœèµ„æºæŒ‡æ ‡ API å¯ç”¨ï¼Œåˆ™è¾“å‡ºç»“æœå°†åŒ…å«å¯¹ metrics.k8s.io çš„å¼•ç”¨ä¿¡æ¯ã€‚
NAME v1beta1.metrics.k8s.io åˆ›å»ºå‘½åç©ºé—´ åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼Œä»¥ä¾¿å°†æœ¬ç»ƒä¹ ä¸­åˆ›å»ºçš„èµ„æºä¸é›†ç¾¤çš„å…¶ä½™éƒ¨åˆ†éš”ç¦»ã€‚
kubectl create namespace mem-example æŒ‡å®šå†…å­˜è¯·æ±‚å’Œé™åˆ¶ è¦ä¸ºå®¹å™¨æŒ‡å®šå†…å­˜è¯·æ±‚ï¼Œè¯·åœ¨å®¹å™¨èµ„æºæ¸…å•ä¸­åŒ…å« resourcesï¼šrequests å­—æ®µã€‚ åŒç†ï¼Œè¦æŒ‡å®šå†…å­˜é™åˆ¶ï¼Œè¯·åŒ…å« resourcesï¼šlimitsã€‚
åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰ä¸€ä¸ªå®¹å™¨çš„ Podã€‚ å®¹å™¨å°†ä¼šè¯·æ±‚ 100 MiB å†…å­˜ï¼Œå¹¶ä¸”å†…å­˜ä¼šè¢«é™åˆ¶åœ¨ 200 MiB ä»¥å†…ã€‚ è¿™æ˜¯ Pod çš„é…ç½®æ–‡ä»¶ï¼š</description>
    </item>
    
    <item>
      <title>ä¸º Windows çš„ pod å’Œå®¹å™¨é…ç½® RunAsUserName</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-runasusername/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-runasusername/</guid>
      <description>. feature-state for_k8s_version=&amp;quot;v1.17&amp;rdquo; state=&amp;quot;beta&amp;rdquo; &amp;gt;}}
æœ¬é¡µå±•ç¤ºå¦‚ä½•ä¸ºè¿è¡Œåœ¨ Windows èŠ‚ç‚¹ä¸Šçš„ pod å’Œå®¹å™¨å¯ç”¨å¹¶ä½¿ç”¨ RunAsUserName åŠŸèƒ½ã€‚æ­¤åŠŸèƒ½æ—¨åœ¨æˆä¸º Windows ç‰ˆçš„ runAsUserï¼ˆLinuxï¼‰ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨ä¸é»˜è®¤ç”¨æˆ·åä¸åŒçš„ç”¨æˆ·åè¿è¡Œå®¹å™¨ entrypointã€‚
. note &amp;gt;}}
è¯¥åŠŸèƒ½ç›®å‰å¤„äº beta çŠ¶æ€ã€‚ RunAsUserName çš„æ•´ä½“åŠŸèƒ½ä¸ä¼šå‡ºç°å˜æ›´ï¼Œä½†æ˜¯å…³äºç”¨æˆ·åéªŒè¯çš„éƒ¨åˆ†å¯èƒ½ä¼šæœ‰æ‰€æ›´æ”¹ã€‚ . /note &amp;gt;}}
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} ä½ å¿…é¡»æœ‰ä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œå¹¶ä¸” kubectl å¿…é¡»èƒ½å’Œé›†ç¾¤é€šä¿¡ã€‚é›†ç¾¤åº”è¯¥è¦æœ‰ Windows å·¥ä½œèŠ‚ç‚¹ï¼Œå°†åœ¨å…¶ä¸­è°ƒåº¦è¿è¡Œ Windows å·¥ä½œè´Ÿè½½çš„ pod å’Œå®¹å™¨ã€‚
ä¸º Pod è®¾ç½® Username è¦æŒ‡å®šè¿è¡Œ Pod å®¹å™¨æ—¶æ‰€ä½¿ç”¨çš„ç”¨æˆ·åï¼Œè¯·åœ¨ Pod å£°æ˜ä¸­åŒ…å« securityContext ï¼ˆ[PodSecurityContext](/docs/reference/generated/kubernetes-api/. param &amp;ldquo;version&amp;rdquo; &amp;gt;}}/#podsecuritycontext-v1-core)ï¼‰å­—æ®µï¼Œå¹¶åœ¨å…¶å†…éƒ¨åŒ…å« windowsOptions ï¼ˆ[WindowsSecurityContextOptions](/docs/reference/generated/kubernetes-api/. param &amp;ldquo;version&amp;rdquo; &amp;gt;}}/#windowssecuritycontextoptions-v1-core)ï¼‰å­—æ®µçš„ runAsUserName å­—æ®µã€‚
æ‚¨ä¸º Pod æŒ‡å®šçš„ Windows SecurityContext é€‰é¡¹é€‚ç”¨äºè¯¥ Pod ä¸­ï¼ˆåŒ…æ‹¬ init å®¹å™¨ï¼‰çš„æ‰€æœ‰å®¹å™¨ã€‚</description>
    </item>
    
    <item>
      <title>ä¸ºå®¹å™¨å’Œ Pods åˆ†é… CPU èµ„æº</title>
      <link>https://lijun.in/tasks/configure-pod-container/assign-cpu-resource/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/assign-cpu-resource/</guid>
      <description>æ­¤é¡µé¢æ˜¾ç¤ºå¦‚ä½•å°† CPU request å’Œ CPU limit åˆ†é…ç»™ä¸€ä¸ªå®¹å™¨ã€‚å®¹å™¨ä½¿ç”¨çš„ CPU ä¸èƒ½è¶…è¿‡é…é¢é™åˆ¶ã€‚ å¦‚æœç³»ç»Ÿæœ‰ç©ºé—²çš„ CPU æ—¶é—´ï¼Œåˆ™å¯ä»¥ä¿è¯æ ¹æ®è¯·æ±‚ç»™å®¹å™¨åˆ†é…å°½å¯èƒ½å¤šçš„ CPU èµ„æºã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»è‡³å°‘å…·æœ‰ 1 ä¸ª CPUã€‚
æ­¤é¡µé¢ä¸Šçš„ä¸€äº›æ­¥éª¤è¦æ±‚æ‚¨åœ¨é›†ç¾¤ä¸­è¿è¡Œmetrics-server æœåŠ¡ã€‚å¦‚æœæ‚¨çš„é›†ç¾¤ä¸­å·²ç»æœ‰æ­£åœ¨è¿è¡Œçš„ metrics-server æœåŠ¡ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥è·³è¿‡è¿™äº›æ­¥éª¤ã€‚
å¦‚æœæ‚¨æ­£åœ¨è¿è¡Œ. glossary_tooltip term_id=&amp;quot;minikube&amp;rdquo; &amp;gt;}}ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ç”¨ metrics-serverï¼š
minikube addons enable metrics-server æŸ¥çœ‹æ˜¯ metrics-serverï¼ˆæˆ–è€…å…¶ä»–èµ„æºåº¦é‡ API æœåŠ¡æä¾›è€…ï¼Œmetrics.k8s.io ï¼‰æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œè¯·é”®å…¥ä»¥ä¸‹å‘½ä»¤ï¼š
kubectl get apiservices å¦‚æœèµ„æºæŒ‡æ ‡ API å¯ç”¨ï¼Œåˆ™ä¼šè¾“å‡ºå°†åŒ…å«ä¸€ä¸ªå‚è€ƒä¿¡æ¯ metrics.k8s.ioã€‚
NAME v1beta1.metrics.k8s.io åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ . glossary_tooltip term_id=&amp;quot;namespace&amp;rdquo; &amp;gt;}}ï¼Œä»¥ä¾¿åœ¨æœ¬ç»ƒä¹ ä¸­åˆ›å»ºçš„èµ„æºä¸é›†ç¾¤çš„å…¶ä½™éƒ¨åˆ†èµ„æºéš”ç¦»ã€‚
kubectl create namespace cpu-example æŒ‡å®šä¸€ä¸ª CPU è¯·æ±‚å’Œ CPU é™åˆ¶ è¦ä¸ºå®¹å™¨æŒ‡å®š CPU è¯·æ±‚ï¼Œè¯·åŒ…å« resourcesï¼šrequests å­—æ®µ åœ¨å®¹å™¨èµ„æºæ¸…å•ä¸­ã€‚è¦æŒ‡å®š CPU é™åˆ¶ï¼Œè¯·åŒ…å« resourcesï¼šlimitsã€‚</description>
    </item>
    
    <item>
      <title>é…ç½® Pod çš„æœåŠ¡è´¨é‡</title>
      <link>https://lijun.in/tasks/configure-pod-container/quality-service-pod/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/quality-service-pod/</guid>
      <description>æœ¬æ–‡ä»‹ç»æ€æ ·é…ç½® Pod è®©å…¶è·å¾—ç‰¹å®šçš„æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰ç±»ã€‚Kubernetes ä½¿ç”¨ QoS ç±»æ¥å†³å®š Pod çš„è°ƒåº¦å’Œé©±é€ç­–ç•¥ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
QoS ç±» Kubernetes åˆ›å»º Pod æ—¶å°±ç»™å®ƒæŒ‡å®šäº†ä¸‹åˆ—ä¸€ç§ QoS ç±»ï¼š
 Guaranteed Burstable BestEffort  åˆ›å»ºå‘½åç©ºé—´ åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼Œä»¥ä¾¿å°†æœ¬ç»ƒä¹ æ‰€åˆ›å»ºçš„èµ„æºä¸é›†ç¾¤çš„å…¶ä½™èµ„æºç›¸éš”ç¦»ã€‚
kubectl create namespace qos-example åˆ›å»ºä¸€ä¸ª QoS ç±»ä¸º Guaranteed çš„ Pod å¯¹äº QoS ç±»ä¸º Guaranteed çš„ Podï¼š
 Pod ä¸­çš„æ¯ä¸ªå®¹å™¨å¿…é¡»æŒ‡å®šå†…å­˜è¯·æ±‚å’Œå†…å­˜é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤è€…è¦ç›¸ç­‰ã€‚ Pod ä¸­çš„æ¯ä¸ªå®¹å™¨å¿…é¡»æŒ‡å®š CPU è¯·æ±‚å’Œ CPU é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤è€…è¦ç›¸ç­‰ã€‚  ä¸‹é¢æ˜¯åŒ…å«ä¸€ä¸ªå®¹å™¨çš„ Pod é…ç½®æ–‡ä»¶ã€‚ å®¹å™¨è®¾ç½®äº†å†…å­˜è¯·æ±‚å’Œå†…å­˜é™åˆ¶ï¼Œå€¼éƒ½æ˜¯ 200 MiBã€‚ å®¹å™¨è®¾ç½®äº† CPU è¯·æ±‚å’Œ CPU é™åˆ¶ï¼Œå€¼éƒ½æ˜¯ 700 milliCPUï¼š</description>
    </item>
    
    <item>
      <title>ä¸ºå®¹å™¨åˆ†æ´¾æ‰©å±•èµ„æº</title>
      <link>https://lijun.in/tasks/configure-pod-container/extended-resource/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/extended-resource/</guid>
      <description>. feature-state state=&amp;quot;stable&amp;rdquo; &amp;gt;}}
æœ¬æ–‡ä»‹ç»å¦‚ä½•ä¸ºå®¹å™¨æŒ‡å®šæ‰©å±•èµ„æºã€‚
. feature-state state=&amp;quot;stable&amp;rdquo; &amp;gt;}}
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
åœ¨æ‚¨å¼€å§‹æ­¤ç»ƒä¹ å‰ï¼Œè¯·å…ˆç»ƒä¹ ä¸ºèŠ‚ç‚¹å¹¿æ’­æ‰©å±•èµ„æºã€‚ åœ¨é‚£ä¸ªç»ƒä¹ ä¸­å°†é…ç½®æ‚¨çš„ä¸€ä¸ªèŠ‚ç‚¹æ¥å¹¿æ’­ dongle èµ„æºã€‚
ç»™ Pod åˆ†æ´¾æ‰©å±•èµ„æº è¦è¯·æ±‚æ‰©å±•èµ„æºï¼Œéœ€è¦åœ¨æ‚¨çš„å®¹å™¨æ¸…å•ä¸­åŒ…æ‹¬ resources:requests å­—æ®µã€‚ æ‰©å±•èµ„æºå¯ä»¥ä½¿ç”¨ä»»ä½•å®Œå…¨é™å®šåç§°ï¼Œåªæ˜¯ä¸èƒ½ä½¿ç”¨ *.kubernetes.io/ã€‚ æœ‰æ•ˆçš„æ‰©å±•èµ„æºåçš„æ ¼å¼ä¸º example.com/fooï¼Œå…¶ä¸­ example.com åº”è¢«æ›¿æ¢ä¸ºæ‚¨çš„ç»„ç»‡çš„åŸŸåï¼Œè€Œ foo åˆ™æ˜¯æè¿°æ€§çš„èµ„æºåç§°ã€‚
ä¸‹é¢æ˜¯åŒ…å«ä¸€ä¸ªå®¹å™¨çš„ Pod é…ç½®æ–‡ä»¶ï¼š
. codenew file=&amp;quot;pods/resource/extended-resource-pod.yaml&amp;rdquo; &amp;gt;}}
åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å®¹å™¨è¯·æ±‚äº† 3 ä¸ª donglesã€‚
åˆ›å»º Podï¼š
kubectl apply -f https://k8s.io/examples/pods/resource/extended-resource-pod.yaml æ£€æŸ¥ Pod æ˜¯å¦è¿è¡Œæ­£å¸¸ï¼š
kubectl get pod extended-resource-demo æè¿° Pod:
kubectl describe pod extended-resource-demo è¾“å‡ºç»“æœæ˜¾ç¤º dongle è¯·æ±‚å¦‚ä¸‹ï¼š</description>
    </item>
    
    <item>
      <title>é…ç½® Pod ä»¥ä½¿ç”¨å·è¿›è¡Œå­˜å‚¨</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-volume-storage/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-volume-storage/</guid>
      <description>æ­¤é¡µé¢å±•ç¤ºäº†å¦‚ä½•é…ç½® Pod ä»¥ä½¿ç”¨å·è¿›è¡Œå­˜å‚¨ã€‚
åªè¦å®¹å™¨å­˜åœ¨ï¼Œå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿå°±ä¼šå­˜åœ¨ï¼Œå› æ­¤å½“ä¸€ä¸ªå®¹å™¨ç»ˆæ­¢å¹¶é‡æ–°å¯åŠ¨ï¼Œå¯¹è¯¥å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ”¹åŠ¨å°†ä¸¢å¤±ã€‚å¯¹äºç‹¬ç«‹äºå®¹å™¨çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å·ã€‚è¿™å¯¹äºæœ‰çŠ¶æ€åº”ç”¨ç¨‹åºå°¤ä¸ºé‡è¦ï¼Œä¾‹å¦‚é”®å€¼å­˜å‚¨ï¼ˆå¦‚ Redisï¼‰å’Œæ•°æ®åº“ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
ä¸º Pod é…ç½®å· åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªè¿è¡Œ Podï¼Œè¯¥ Pod ä»…è¿è¡Œä¸€ä¸ªå®¹å™¨å¹¶æ‹¥æœ‰ä¸€ä¸ªç±»å‹ä¸º emptyDir çš„å·ï¼Œåœ¨æ•´ä¸ª Pod ç”Ÿå‘½å‘¨æœŸä¸­ä¸€ç›´å­˜åœ¨ï¼Œå³ä½¿ Pod ä¸­çš„å®¹å™¨è¢«ç»ˆæ­¢å’Œé‡å¯ã€‚ä»¥ä¸‹æ˜¯ Pod çš„é…ç½®ï¼š
. codenew file=&amp;quot;pods/storage/redis.yaml&amp;rdquo; &amp;gt;}}
 åˆ›å»º Pod:  ```shell kubectl apply -f https://k8s.io/examples/pods/storage/redis.yaml ```   éªŒè¯ Pod ä¸­çš„å®¹å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œç„¶åç•™æ„ Pod çš„æ›´æ”¹ï¼š  ```shell kubectl get pod redis --watch ``` è¾“å‡ºå¦‚ä¸‹ï¼š ```shell NAME READY STATUS RESTARTS AGE redis 1/1 Running 0 13s ```   åœ¨å¦ä¸€ä¸ªç»ˆç«¯ï¼Œç”¨ shell è¿æ¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š  ```shell kubectl exec -it redis -- /bin/bash ```   åœ¨æ‚¨çš„ shell ç»ˆç«¯ä¸­ï¼Œåˆ‡æ¢åˆ° /data/redis ç›®å½•ä¸‹ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š  ```shell root@redis:/data# cd /data/redis/ root@redis:/data/redis# echo Hello &amp;gt; test-file ```   åœ¨æ‚¨çš„ shell ç»ˆç«¯ä¸­ï¼Œåˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼š  ```shell root@redis:/data/redis# apt-get update root@redis:/data/redis# apt-get install procps root@redis:/data/redis# ps aux ``` è¾“å‡ºç±»ä¼¼äºï¼š ```shell USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND redis 1 0.</description>
    </item>
    
    <item>
      <title>é…ç½® Pod ä»¥ä½¿ç”¨ PersistentVolume ä½œä¸ºå­˜å‚¨</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-persistent-volume-storage/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-persistent-volume-storage/</guid>
      <description>æœ¬æ–‡ä»‹ç»å¦‚ä½•é…ç½® Pod ä½¿ç”¨ PersistentVolumeClaim ä½œä¸ºå­˜å‚¨ã€‚ ä»¥ä¸‹æ˜¯è¯¥è¿‡ç¨‹çš„æ€»ç»“ï¼š
  é›†ç¾¤ç®¡ç†å‘˜åˆ›å»ºç”±ç‰©ç†å­˜å‚¨æ”¯æŒçš„ PersistentVolumeã€‚ç®¡ç†å‘˜ä¸å°†å·ä¸ä»»ä½• Pod å…³è”ã€‚
  ç¾¤é›†ç”¨æˆ·åˆ›å»ºä¸€ä¸ª PersistentVolumeClaimï¼Œå®ƒå°†è‡ªåŠ¨ç»‘å®šåˆ°åˆé€‚çš„ PersistentVolumeã€‚
  ç”¨æˆ·åˆ›å»ºä¸€ä¸ªä½¿ç”¨ PersistentVolumeClaim ä½œä¸ºå­˜å‚¨çš„ Podã€‚
  . heading &amp;ldquo;prerequisites&amp;rdquo; %}}   æ‚¨éœ€è¦ä¸€ä¸ªåŒ…å«å•ä¸ªèŠ‚ç‚¹çš„ Kubernetes é›†ç¾¤ï¼Œå¹¶ä¸”å¿…é¡»é…ç½® kubectl å‘½ä»¤è¡Œå·¥å…·ä»¥ä¾¿ä¸é›†ç¾¤äº¤äº’ã€‚ å¦‚æœè¿˜æ²¡æœ‰å•èŠ‚ç‚¹é›†ç¾¤ï¼Œå¯ä»¥ä½¿ç”¨ Minikube åˆ›å»ºä¸€ä¸ªã€‚
  ç†Ÿæ‚‰æŒä¹…å·ä¸­çš„ææ–™ã€‚
  åœ¨ä½ çš„èŠ‚ç‚¹ä¸Šåˆ›å»ºä¸€ä¸ª index.html æ–‡ä»¶ æ‰“å¼€é›†ç¾¤ä¸­èŠ‚ç‚¹çš„ä¸€ä¸ª shellã€‚ å¦‚ä½•æ‰“å¼€ shell å–å†³äºé›†ç¾¤çš„è®¾ç½®ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Minikubeï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¾“å…¥ minikube ssh æ¥æ‰“å¼€èŠ‚ç‚¹çš„ shellã€‚
åœ¨ shell ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª /mnt/data ç›®å½•ï¼š
mkdir /mnt/data  åœ¨ /mnt/data ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª index.html æ–‡ä»¶ï¼š</description>
    </item>
    
    <item>
      <title>é…ç½® Pod ä½¿ç”¨æŠ•å°„å·ä½œå­˜å‚¨</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-projected-volume-storage/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-projected-volume-storage/</guid>
      <description>æœ¬æ–‡ä»‹ç»æ€æ ·é€šè¿‡æŠ•å°„ å·å°†ç°æœ‰çš„å¤šä¸ªå·èµ„æºæŒ‚è½½åˆ°ç›¸åŒçš„ç›®å½•ã€‚ å½“å‰ï¼Œsecretã€configMapã€downwardAPI å’Œ serviceAccountToken å·å¯ä»¥è¢«æŠ•å°„ã€‚
. note &amp;gt;}}
serviceAccountToken ä¸æ˜¯ä¸€ç§å·ç±»å‹ . /note &amp;gt;}}
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
ä¸º Pod é…ç½®æŠ•å°„å· æœ¬ç»ƒä¹ ä¸­ï¼Œæ‚¨å°†ä»æœ¬åœ°æ–‡ä»¶æ¥åˆ›å»ºåŒ…å«æœ‰ç”¨æˆ·åå’Œå¯†ç çš„ Secretã€‚ç„¶ååˆ›å»ºè¿è¡Œä¸€ä¸ªå®¹å™¨çš„ Podï¼Œè¯¥ Pod ä½¿ç”¨æŠ•å°„ å·å°† Secret æŒ‚è½½åˆ°ç›¸åŒçš„è·¯å¾„ä¸‹ã€‚
ä¸‹é¢æ˜¯ Pod çš„é…ç½®æ–‡ä»¶ï¼š
. codenew file=&amp;quot;pods/storage/projected.yaml&amp;rdquo; &amp;gt;}}
    &amp;lt;!--# Create files containing the username and password:--&amp;gt;# åˆ›å»ºåŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„æ–‡ä»¶: echo -n &amp;#34;admin&amp;#34; &amp;gt; ./username.txt echo -n &amp;#34;1f2d1e2e67df&amp;#34; &amp;gt; ./password.txt--&amp;gt; &amp;lt;!--# Package these files into secrets:--&amp;gt;# å°†ä¸Šè¿°æ–‡ä»¶å¼•ç”¨åˆ° Secretï¼š kubectl create secret generic user --from-file=.</description>
    </item>
    
    <item>
      <title>ä¸º Pod é…ç½®æœåŠ¡è´¦æˆ·</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-service-account/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-service-account/</guid>
      <description>æœåŠ¡è´¦æˆ·ä¸º Pod ä¸­è¿è¡Œçš„è¿›ç¨‹æä¾›äº†ä¸€ä¸ªæ ‡è¯†ã€‚
æœ¬æ–‡æ˜¯æœåŠ¡è´¦æˆ·çš„ç”¨æˆ·ä½¿ç”¨ä»‹ç»ã€‚æ‚¨ä¹Ÿå¯ä»¥å‚è€ƒé›†ç¾¤ç®¡ç†æŒ‡å—ä¹‹æœåŠ¡è´¦æˆ·ã€‚
. note &amp;gt;}}
æœ¬æ–‡æ¡£æè¿° Kubernetes é¡¹ç›®æ¨èçš„é›†ç¾¤ä¸­æœåŠ¡å¸æˆ·çš„è¡Œä¸ºã€‚ é›†ç¾¤ç®¡ç†å‘˜ä¹Ÿå¯èƒ½å·²ç»å®šåˆ¶äº†æœåŠ¡è´¦æˆ·åœ¨é›†ç¾¤ä¸­çš„å±æ€§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ¬æ–‡æ¡£å¯èƒ½å¹¶ä¸é€‚ç”¨ã€‚
. /note &amp;gt;}}
å½“æ‚¨ï¼ˆäººç±»ï¼‰è®¿é—®é›†ç¾¤æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ kubectlï¼‰ï¼Œapi æœåŠ¡å™¨å°†æ‚¨çš„èº«ä»½éªŒè¯ä¸ºç‰¹å®šçš„ç”¨æˆ·å¸æˆ·ï¼ˆå½“å‰è¿™é€šå¸¸æ˜¯ adminï¼Œé™¤éæ‚¨çš„é›†ç¾¤ç®¡ç†å‘˜å·²ç»å®šåˆ¶äº†æ‚¨çš„é›†ç¾¤é…ç½®ï¼‰ã€‚ Pod å†…çš„å®¹å™¨ä¸­çš„è¿›ç¨‹ä¹Ÿå¯ä»¥ä¸ api æœåŠ¡å™¨æ¥è§¦ã€‚ å½“å®ƒä»¬è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œå®ƒä»¬è¢«éªŒè¯ä¸ºç‰¹å®šçš„æœåŠ¡å¸æˆ·ï¼ˆä¾‹å¦‚ï¼Œdefaultï¼‰ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
ä½¿ç”¨é»˜è®¤çš„æœåŠ¡è´¦æˆ·è®¿é—® API æœåŠ¡å™¨ å½“æ‚¨åˆ›å»º Pod æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæœåŠ¡è´¦æˆ·ï¼ŒPod ä¼šè¢«æŒ‡å®šå‘½åç©ºé—´ä¸­çš„defaultæœåŠ¡è´¦æˆ·ã€‚ å¦‚æœæ‚¨æŸ¥çœ‹ Pod çš„åŸå§‹ json æˆ– yamlï¼ˆä¾‹å¦‚ï¼škubectl get pods/podname -o yamlï¼‰ï¼Œ æ‚¨å¯ä»¥çœ‹åˆ° spec.serviceAccountName å­—æ®µå·²ç»è¢«è‡ªåŠ¨è®¾ç½®äº†ã€‚
æ‚¨å¯ä»¥ä½¿ç”¨è‡ªåŠ¨æŒ‚è½½ç»™ Pod çš„æœåŠ¡è´¦æˆ·å‡­æ®è®¿é—® APIï¼Œè®¿é—®é›†ç¾¤ ä¸­æœ‰ç›¸å…³æè¿°ã€‚ æœåŠ¡è´¦æˆ·çš„ API è®¸å¯å–å†³äºæ‚¨æ‰€ä½¿ç”¨çš„æˆæƒæ’ä»¶å’Œç­–ç•¥ã€‚
åœ¨ 1.6 ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨æœåŠ¡è´¦æˆ·ä¸Šè®¾ç½® automountServiceAccountToken: false æ¥å®ç°ä¸ç»™æœåŠ¡è´¦å·è‡ªåŠ¨æŒ‚è½½ API å‡­æ®ï¼š</description>
    </item>
    
    <item>
      <title>ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ</title>
      <link>https://lijun.in/tasks/configure-pod-container/pull-image-private-registry/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/pull-image-private-registry/</guid>
      <description>æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Secret ä»ç§æœ‰çš„ Docker é•œåƒä»“åº“æˆ–ä»£ç ä»“åº“æ‹‰å–é•œåƒæ¥åˆ›å»º Podã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}}  . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}  æ‚¨éœ€è¦ Docker ID å’Œå¯†ç æ¥è¿›è¡Œæœ¬ç»ƒä¹ ã€‚
ç™»å½• Docker é•œåƒä»“åº“ åœ¨ä¸ªäººç”µè„‘ä¸Šï¼Œè¦æƒ³æ‹‰å–ç§æœ‰é•œåƒå¿…é¡»åœ¨é•œåƒä»“åº“ä¸Šè¿›è¡Œèº«ä»½éªŒè¯ã€‚
docker login å½“æç¤ºæ—¶ï¼Œè¾“å…¥ Docker ç”¨æˆ·åå’Œå¯†ç ã€‚
ç™»å½•è¿‡ç¨‹ä¼šåˆ›å»ºæˆ–æ›´æ–°ä¿å­˜æœ‰æˆæƒä»¤ç‰Œçš„ config.json æ–‡ä»¶ã€‚
æŸ¥çœ‹ config.json æ–‡ä»¶ï¼š
cat ~/.docker/config.json è¾“å‡ºç»“æœåŒ…å«ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„éƒ¨åˆ†ï¼š
{ &amp;#34;auths&amp;#34;: { &amp;#34;https://index.docker.io/v1/&amp;#34;: { &amp;#34;auth&amp;#34;: &amp;#34;c3R...zE2&amp;#34; } } } . note &amp;gt;}}
å¦‚æœä½¿ç”¨ Docker å‡­è¯ä»“åº“ï¼Œåˆ™ä¸ä¼šçœ‹åˆ° auth æ¡ç›®ï¼Œçœ‹åˆ°çš„å°†æ˜¯ä»¥ä»“åº“åç§°ä½œä¸ºå€¼çš„ credsStore æ¡ç›®ã€‚ . /note &amp;gt;}}
åœ¨é›†ç¾¤ä¸­åˆ›å»ºä¿å­˜æˆæƒä»¤ç‰Œçš„ Secret Kubernetes é›†ç¾¤ä½¿ç”¨ docker-registry ç±»å‹çš„ Secret æ¥é€šè¿‡å®¹å™¨ä»“åº“çš„èº«ä»½éªŒè¯ï¼Œè¿›è€Œæå–ç§æœ‰æ˜ åƒã€‚</description>
    </item>
    
    <item>
      <title>é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/</guid>
      <description>è¿™ç¯‡æ–‡ç« ä»‹ç»å¦‚ä½•ç»™å®¹å™¨é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨ã€‚
kubelet ä½¿ç”¨å­˜æ´»æ¢æµ‹å™¨æ¥çŸ¥é“ä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œå­˜æ´»æ¢æµ‹å™¨å¯ä»¥æ•æ‰åˆ°æ­»é”ï¼ˆåº”ç”¨ç¨‹åºåœ¨è¿è¡Œï¼Œä½†æ˜¯æ— æ³•ç»§ç»­æ‰§è¡Œåé¢çš„æ­¥éª¤ï¼‰ã€‚è¿™æ ·çš„æƒ…å†µä¸‹é‡å¯å®¹å™¨æœ‰åŠ©äºè®©åº”ç”¨ç¨‹åºåœ¨æœ‰é—®é¢˜çš„æƒ…å†µä¸‹æ›´å¯ç”¨ã€‚
kubelet ä½¿ç”¨å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä»€ä¹ˆæ—¶å€™å‡†å¤‡å¥½äº†å¹¶å¯ä»¥å¼€å§‹æ¥å—è¯·æ±‚æµé‡ï¼Œ å½“ä¸€ä¸ª Pod å†…çš„æ‰€æœ‰å®¹å™¨éƒ½å‡†å¤‡å¥½äº†ï¼Œæ‰èƒ½æŠŠè¿™ä¸ª Pod çœ‹ä½œå°±ç»ªäº†ã€‚è¿™ç§ä¿¡å·çš„ä¸€ä¸ªç”¨é€”å°±æ˜¯æ§åˆ¶å“ªä¸ª Pod ä½œä¸º Service çš„åç«¯ã€‚åœ¨ Pod è¿˜æ²¡æœ‰å‡†å¤‡å¥½çš„æ—¶å€™ï¼Œä¼šä» Service çš„è´Ÿè½½å‡è¡¡å™¨ä¸­è¢«å‰”é™¤çš„ã€‚
kubelet ä½¿ç”¨å¯åŠ¨æ¢æµ‹å™¨å¯ä»¥çŸ¥é“åº”ç”¨ç¨‹åºå®¹å™¨ä»€ä¹ˆæ—¶å€™å¯åŠ¨äº†ã€‚å¦‚æœé…ç½®äº†è¿™ç±»æ¢æµ‹å™¨ï¼Œå°±å¯ä»¥æ§åˆ¶å®¹å™¨åœ¨å¯åŠ¨æˆåŠŸåå†è¿›è¡Œå­˜æ´»æ€§å’Œå°±ç»ªæ£€æŸ¥ï¼Œç¡®ä¿è¿™äº›å­˜æ´»ã€å°±ç»ªæ¢æµ‹å™¨ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„å¯åŠ¨ã€‚è¿™å¯ä»¥ç”¨äºå¯¹æ…¢å¯åŠ¨å®¹å™¨è¿›è¡Œå­˜æ´»æ€§æ£€æµ‹ï¼Œé¿å…å®ƒä»¬åœ¨å¯åŠ¨è¿è¡Œä¹‹å‰å°±è¢«æ€æ‰ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
å®šä¹‰å­˜æ´»å‘½ä»¤ è®¸å¤šé•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ç¨‹åºæœ€ç»ˆä¼šè¿‡æ¸¡åˆ°æ–­å¼€çš„çŠ¶æ€ï¼Œé™¤éé‡æ–°å¯åŠ¨ï¼Œå¦åˆ™æ— æ³•æ¢å¤ã€‚Kubernetes æä¾›äº†å­˜æ´»æ¢æµ‹å™¨æ¥å‘ç°å¹¶è¡¥æ•‘è¿™ç§æƒ…å†µã€‚
åœ¨è¿™ç¯‡ç»ƒä¹ ä¸­ï¼Œä¼šåˆ›å»ºä¸€ä¸ª Podï¼Œå…¶ä¸­è¿è¡Œä¸€ä¸ªåŸºäº k8s.gcr.io/busybox é•œåƒçš„å®¹å™¨ã€‚ä¸‹é¢æ˜¯è¿™ä¸ª Pod çš„é…ç½®æ–‡ä»¶ã€‚
. codenew file=&amp;quot;pods/probe/exec-liveness.yaml&amp;rdquo; &amp;gt;}}
åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ° Pod ä¸­åªæœ‰ä¸€ä¸ªå®¹å™¨ã€‚periodSeconds å­—æ®µæŒ‡å®šäº† kubelet åº”è¯¥æ¯ 5 ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚initialDelaySeconds å­—æ®µå‘Šè¯‰ kubelet åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰åº”è¯¥ç­‰å¾… 5 ç§’ã€‚kubelet åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ cat /tmp/healthy æ¥è¿›è¡Œæ¢æµ‹ã€‚å¦‚æœå‘½ä»¤æ‰§è¡ŒæˆåŠŸå¹¶ä¸”è¿”å›å€¼ä¸º 0ï¼Œkubelet å°±ä¼šè®¤ä¸ºè¿™ä¸ªå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚å¦‚æœè¿™ä¸ªå‘½ä»¤è¿”å›é 0 å€¼ï¼Œkubelet ä¼šæ€æ­»è¿™ä¸ªå®¹å™¨å¹¶é‡æ–°å¯åŠ¨å®ƒã€‚
å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œæ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š
/bin/sh -c &amp;#34;touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600&amp;#34; è¿™ä¸ªå®¹å™¨ç”Ÿå‘½çš„å‰ 30 ç§’ï¼Œ /tmp/healthy æ–‡ä»¶æ˜¯å­˜åœ¨çš„ã€‚æ‰€ä»¥åœ¨è¿™æœ€å¼€å§‹çš„ 30 ç§’å†…ï¼Œæ‰§è¡Œå‘½ä»¤ cat /tmp/healthy ä¼šè¿”å›æˆåŠŸç ã€‚30 ç§’ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ cat /tmp/healthy å°±ä¼šè¿”å›å¤±è´¥ç ã€‚</description>
    </item>
    
    <item>
      <title>å°† Pod åˆ†é…ç»™èŠ‚ç‚¹</title>
      <link>https://lijun.in/tasks/configure-pod-container/assign-pods-nodes/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/assign-pods-nodes/</guid>
      <description>æ­¤é¡µé¢æ˜¾ç¤ºå¦‚ä½•å°† Kubernetes Pod åˆ†é…ç»™ Kubernetes é›†ç¾¤ä¸­çš„ç‰¹å®šèŠ‚ç‚¹ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
ç»™èŠ‚ç‚¹æ·»åŠ æ ‡ç­¾   åˆ—å‡ºé›†ç¾¤ä¸­çš„èŠ‚ç‚¹
 kubectl get nodes  è¾“å‡ºç±»ä¼¼å¦‚ä¸‹ï¼š
 NAME STATUS AGE VERSION worker0 Ready 1d v1.6.0+fff5156 worker1 Ready 1d v1.6.0+fff5156 worker2 Ready 1d v1.6.0+fff5156      é€‰æ‹©å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸ºå®ƒæ·»åŠ æ ‡ç­¾ï¼š
 kubectl label nodes &amp;lt;your-node-name&amp;gt; disktype=ssd  &amp;lt;your-node-name&amp;gt; æ˜¯ä½ é€‰æ‹©çš„èŠ‚ç‚¹çš„åç§°ã€‚
    éªŒè¯ä½ é€‰æ‹©çš„èŠ‚ç‚¹æ˜¯å¦æœ‰ disktype=ssd æ ‡ç­¾ï¼š
 kubectl get nodes --show-labels  è¾“å‡ºç±»ä¼¼å¦‚ä¸‹ï¼š</description>
    </item>
    
    <item>
      <title>é…ç½® Pod åˆå§‹åŒ–</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-pod-initialization/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-pod-initialization/</guid>
      <description>æœ¬æ–‡ä»‹ç»åœ¨åº”ç”¨å®¹å™¨è¿è¡Œå‰ï¼Œæ€æ ·åˆ©ç”¨ Init å®¹å™¨åˆå§‹åŒ– Podã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
åˆ›å»ºä¸€ä¸ªåŒ…å« Init å®¹å™¨çš„ Pod æœ¬ä¾‹ä¸­æ‚¨å°†åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªåº”ç”¨å®¹å™¨å’Œä¸€ä¸ª Init å®¹å™¨çš„ Podã€‚Init å®¹å™¨åœ¨åº”ç”¨å®¹å™¨å¯åŠ¨å‰è¿è¡Œå®Œæˆã€‚
ä¸‹é¢æ˜¯ Pod çš„é…ç½®æ–‡ä»¶ï¼š
. codenew file=&amp;quot;pods/init-containers.yaml&amp;rdquo; &amp;gt;}}
é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åº”ç”¨å®¹å™¨å’Œ Init å®¹å™¨å…±äº«äº†ä¸€ä¸ªå·ã€‚
Init å®¹å™¨å°†å…±äº«å·æŒ‚è½½åˆ°äº† /work-dir ç›®å½•ï¼Œåº”ç”¨å®¹å™¨å°†å…±äº«å·æŒ‚è½½åˆ°äº† /usr/share/nginx/html ç›®å½•ã€‚ Init å®¹å™¨æ‰§è¡Œå®Œä¸‹é¢çš„å‘½ä»¤å°±ç»ˆæ­¢ï¼š
wget -O /work-dir/index.html http://kubernetes.io  è¯·æ³¨æ„ Init å®¹å™¨åœ¨ nginx æœåŠ¡å™¨çš„æ ¹ç›®å½•å†™å…¥ index.htmlã€‚
åˆ›å»º Podï¼š
kubectl create -f https://k8s.io/examples/pods/init-containers.yaml  æ£€æŸ¥ nginx å®¹å™¨è¿è¡Œæ­£å¸¸ï¼š
kubectl get pod init-demo  ç»“æœè¡¨æ˜ nginx å®¹å™¨è¿è¡Œæ­£å¸¸ï¼š</description>
    </item>
    
    <item>
      <title>ä¸ºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶è®¾ç½®å¤„ç†å‡½æ•°</title>
      <link>https://lijun.in/tasks/configure-pod-container/attach-handler-lifecycle-event/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/attach-handler-lifecycle-event/</guid>
      <description>è¿™ä¸ªé¡µé¢å°†æ¼”ç¤ºå¦‚ä½•ä¸ºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æŒ‚æ¥å¤„ç†å‡½æ•°ã€‚Kubernetes æ”¯æŒ postStart å’Œ preStop äº‹ä»¶ã€‚ å½“ä¸€ä¸ªå®¹å™¨å¯åŠ¨åï¼ŒKubernetes å°†ç«‹å³å‘é€ postStart äº‹ä»¶ï¼›åœ¨å®¹å™¨è¢«ç»ˆç»“ä¹‹å‰ï¼Œ Kubernetes å°†å‘é€ä¸€ä¸ª preStop äº‹ä»¶ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
å®šä¹‰ postStart å’Œ preStop å¤„ç†å‡½æ•° åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œä½ å°†åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªå®¹å™¨çš„ Podï¼Œè¯¥å®¹å™¨ä¸º postStart å’Œ preStop äº‹ä»¶æä¾›å¯¹åº”çš„å¤„ç†å‡½æ•°ã€‚
ä¸‹é¢æ˜¯å¯¹åº” Pod çš„é…ç½®æ–‡ä»¶
. codenew file=&amp;quot;pods/lifecycle-events.yaml&amp;rdquo; &amp;gt;}}
åœ¨ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ° postStart å‘½ä»¤åœ¨å®¹å™¨çš„ /usr/share ç›®å½•ä¸‹å†™å…¥æ–‡ä»¶ messageã€‚ å‘½ä»¤ preStop è´Ÿè´£ä¼˜é›…åœ°ç»ˆæ­¢ nginx æœåŠ¡ã€‚å½“å› ä¸ºå¤±æ•ˆè€Œå¯¼è‡´å®¹å™¨ç»ˆæ­¢æ—¶ï¼Œè¿™ä¸€å¤„ç†æ–¹å¼å¾ˆæœ‰ç”¨ã€‚```
åˆ›å»º Podï¼š
kubectl apply -f https://k8s.io/examples/pods/lifecycle-events.yaml  éªŒè¯ Pod ä¸­çš„å®¹å™¨å·²ç»è¿è¡Œï¼š
kubectl get pod lifecycle-demo  ä½¿ç”¨ shell è¿æ¥åˆ°ä½ çš„ Pod é‡Œçš„å®¹å™¨ï¼š</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ ConfigMap é…ç½® Pod</title>
      <link>https://lijun.in/tasks/configure-pod-container/configure-pod-configmap/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/configure-pod-configmap/</guid>
      <description>ConfigMap å…è®¸æ‚¨å°†é…ç½®æ–‡ä»¶ä¸é•œåƒæ–‡ä»¶åˆ†ç¦»ï¼Œä»¥ä½¿å®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºå…·æœ‰å¯ç§»æ¤æ€§ã€‚è¯¥é¡µé¢æä¾›äº†ä¸€ç³»åˆ—ä½¿ç”¨ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å­˜å‚¨åœ¨ ConfigMap ä¸­çš„æ•°æ®åˆ›å»º ConfigMap å’Œé…ç½® Podã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
åˆ›å»º ConfigMap æ‚¨å¯ä»¥åœ¨ kustomization.yaml ä¸­ä½¿ç”¨ kubectl create configmap æˆ– ConfigMap ç”Ÿæˆå™¨æ¥åˆ›å»ºConfigMapã€‚æ³¨æ„ï¼Œä» 1.14 ç‰ˆæœ¬å¼€å§‹ï¼Œ kubectl å¼€å§‹æ”¯æŒ kustomization.yamlã€‚
ä½¿ç”¨ kubectl åˆ›å»º ConfigMap åœ¨ç›®å½•, æ–‡ä»¶, æˆ–è€…æ–‡å­—å€¼ä¸­ä½¿ç”¨ kubectl create configmap å‘½ä»¤åˆ›å»ºconfigmapï¼š
kubectl create configmap &amp;lt;map-name&amp;gt; &amp;lt;data-source&amp;gt; å…¶ä¸­ï¼Œ &amp;lt;map-name&amp;gt; æ˜¯è¦åˆ†é…ç»™ ConfigMap çš„åç§°ï¼Œ&amp;lt;data-source&amp;gt; æ˜¯è¦ä»ä¸­æå–æ•°æ®çš„ç›®å½•ï¼Œæ–‡ä»¶æˆ–è€…æ–‡å­—å€¼ã€‚
æ•°æ®æºå¯¹åº”äº ConfigMap ä¸­çš„ key-value (é”®å€¼å¯¹)
 key = æ‚¨åœ¨å‘½ä»¤è¡Œä¸Šæä¾›çš„æ–‡ä»¶åæˆ–è€…å¯†é’¥ value = æ‚¨åœ¨å‘½ä»¤è¡Œä¸Šæä¾›çš„æ–‡ä»¶å†…å®¹æˆ–è€…æ–‡å­—å€¼  æ‚¨å¯ä»¥ä½¿ç”¨kubectl describeæˆ–è€… kubectl getæ£€ç´¢æœ‰å…³ ConfigMap çš„ä¿¡æ¯ã€‚</description>
    </item>
    
    <item>
      <title>åœ¨ Pod ä¸­çš„å®¹å™¨ä¹‹é—´å…±äº«è¿›ç¨‹å‘½åç©ºé—´</title>
      <link>https://lijun.in/tasks/configure-pod-container/share-process-namespace/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/share-process-namespace/</guid>
      <description>. feature-state state=&amp;quot;stable&amp;rdquo; for_k8s_version=&amp;quot;v1.17&amp;rdquo; &amp;gt;}}
æ­¤é¡µé¢å±•ç¤ºå¦‚ä½•ä¸º pod é…ç½®è¿›ç¨‹å‘½åç©ºé—´å…±äº«ã€‚ å½“å¯ç”¨è¿›ç¨‹å‘½åç©ºé—´å…±äº«æ—¶ï¼Œå®¹å™¨ä¸­çš„è¿›ç¨‹å¯¹è¯¥ pod ä¸­çš„æ‰€æœ‰å…¶ä»–å®¹å™¨éƒ½æ˜¯å¯è§çš„ã€‚
æ‚¨å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½æ¥é…ç½®åä½œå®¹å™¨ï¼Œæ¯”å¦‚æ—¥å¿—å¤„ç† sidecar å®¹å™¨ï¼Œæˆ–è€…å¯¹é‚£äº›ä¸åŒ…å«è¯¸å¦‚ shell ç­‰è°ƒè¯•å®ç”¨å·¥å…·çš„é•œåƒè¿›è¡Œæ•…éšœæ’æŸ¥ã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
é…ç½® Pod è¿›ç¨‹å‘½åç©ºé—´å…±äº«ä½¿ç”¨ v1.PodSpec ä¸­çš„ ShareProcessNamespace å­—æ®µå¯ç”¨ã€‚ä¾‹å¦‚ï¼š
. codenew file=&amp;quot;pods/share-process-namespace.yaml&amp;rdquo; &amp;gt;}}
  åœ¨é›†ç¾¤ä¸­åˆ›å»º nginx podï¼š
kubectl apply -f https://k8s.io/examples/pods/share-process-namespace.yaml   è·å–å®¹å™¨ shellï¼Œæ‰§è¡Œ psï¼š
kubectl attach -it nginx -c shell å¦‚æœæ²¡æœ‰çœ‹åˆ°å‘½ä»¤æç¤ºç¬¦ï¼Œè¯·æŒ‰ enter å›è½¦é”®ã€‚
/ # ps ax PID USER TIME COMMAND 1 root 0:00 /pause 8 root 0:00 nginx: master process nginx -g daemon off; 14 101 0:00 nginx: worker process 15 root 0:00 sh 21 root 0:00 ps ax   æ‚¨å¯ä»¥åœ¨å…¶ä»–å®¹å™¨ä¸­å¯¹è¿›ç¨‹å‘å‡ºä¿¡å·ã€‚ä¾‹å¦‚ï¼Œå‘é€ SIGHUP åˆ° nginx ä»¥é‡å¯å·¥ä½œè¿›ç¨‹ã€‚è¿™éœ€è¦ SYS_PTRACE åŠŸèƒ½ã€‚</description>
    </item>
    
    <item>
      <title>åˆ›å»ºé™æ€ Pod</title>
      <link>https://lijun.in/tasks/configure-pod-container/static-pod/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/static-pod/</guid>
      <description>é™æ€ Pod åœ¨æŒ‡å®šçš„èŠ‚ç‚¹ä¸Šç”± kubelet å®ˆæŠ¤è¿›ç¨‹ç›´æ¥ç®¡ç†ï¼Œä¸éœ€è¦ . glossary_tooltip text=&amp;quot;API æœåŠ¡&amp;rdquo; term_id=&amp;quot;kube-apiserver&amp;rdquo; &amp;gt;}} ç›‘ç®¡ã€‚ ä¸åƒ Pod æ˜¯ç”±æ§åˆ¶é¢ç®¡ç†çš„ï¼ˆä¾‹å¦‚ï¼Œ. glossary_tooltip text=&amp;quot;Deployment&amp;rdquo; term_id=&amp;quot;deployment&amp;rdquo; &amp;gt;}}ï¼‰ï¼›ç›¸å kubelet ç›‘è§†æ¯ä¸ªé™æ€ Podï¼ˆåœ¨å®ƒå´©æºƒä¹‹åé‡æ–°å¯åŠ¨ï¼‰ã€‚
é™æ€ Pod æ°¸è¿œéƒ½ä¼šç»‘å®šåˆ°ä¸€ä¸ªæŒ‡å®šèŠ‚ç‚¹ä¸Šçš„ . glossary_tooltip term_id=&amp;quot;kubelet&amp;rdquo; &amp;gt;}}ã€‚
kubelet ä¼šå°è¯•é€šè¿‡ Kubernetes API æœåŠ¡å™¨ä¸ºæ¯ä¸ªé™æ€ Pod è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª . glossary_tooltip text=&amp;quot;é•œåƒ Pod&amp;rdquo; term_id=&amp;quot;mirror-pod&amp;rdquo; &amp;gt;}}ã€‚ è¿™æ„å‘³ç€èŠ‚ç‚¹ä¸Šè¿è¡Œçš„é™æ€ Pod å¯¹ API æœåŠ¡æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡ API æœåŠ¡å™¨æ¥æ§åˆ¶ã€‚
. note &amp;gt;}} å¦‚æœä½ åœ¨è¿è¡Œä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªé™æ€ Podï¼Œå°±å¯èƒ½éœ€è¦è€ƒè™‘ä½¿ç”¨ . glossary_tooltip text=&amp;quot;DaemonSet&amp;rdquo; term_id=&amp;quot;daemonset&amp;rdquo; &amp;gt;}} æ›¿ä»£è¿™ç§æ–¹å¼ã€‚ . /note &amp;gt;}}
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.</description>
    </item>
    
    <item>
      <title>å°† Docker Compose æ–‡ä»¶è½¬æ¢ä¸º Kubernetes èµ„æº</title>
      <link>https://lijun.in/tasks/configure-pod-container/translate-compose-kubernetes/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lijun.in/tasks/configure-pod-container/translate-compose-kubernetes/</guid>
      <description>Kompose æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ä¸ªè½¬æ¢å·¥å…·ï¼Œå¯å°† composeï¼ˆå³ Docker Composeï¼‰æ‰€ç»„è£…çš„æ‰€æœ‰å†…å®¹è½¬æ¢æˆå®¹å™¨ç¼–æ’å™¨ï¼ˆKubernetes æˆ– OpenShiftï¼‰å¯è¯†åˆ«çš„å½¢å¼ã€‚
æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ Kompose å®˜ç½‘ http://kompose.ioã€‚
. heading &amp;ldquo;prerequisites&amp;rdquo; %}} . include &amp;ldquo;task-tutorial-prereqs.md&amp;rdquo; &amp;gt;}} . version-check &amp;gt;}}
å®‰è£… Kompose æˆ‘ä»¬æœ‰å¾ˆå¤šç§æ–¹å¼å®‰è£… Komposeã€‚é¦–é€‰æ–¹å¼æ˜¯ä»æœ€æ–°çš„ GitHub å‘å¸ƒé¡µé¢ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
GitHub å‘å¸ƒç‰ˆæœ¬ Kompose é€šè¿‡ GitHub å‘å¸ƒç‰ˆæœ¬ï¼Œå‘å¸ƒå‘¨æœŸä¸ºä¸‰æ˜ŸæœŸã€‚æ‚¨å¯ä»¥åœ¨GitHub å‘å¸ƒé¡µé¢ä¸Šçœ‹åˆ°æ‰€æœ‰å½“å‰ç‰ˆæœ¬ã€‚
# Linux curl -L https://github.com/kubernetes/kompose/releases/download/v1.16.0/kompose-linux-amd64 -o kompose # macOS curl -L https://github.com/kubernetes/kompose/releases/download/v1.16.0/kompose-darwin-amd64 -o kompose # Windows curl -L https://github.com/kubernetes/kompose/releases/download/v1.16.0/kompose-windows-amd64.exe -o kompose.exe chmod +x kompose sudo mv ./kompose /usr/local/bin/kompose æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä¸‹è½½ tarballã€‚
Go ç”¨ go get å‘½ä»¤ä»ä¸»åˆ†æ”¯æ‹‰å–æœ€æ–°çš„å¼€å‘å˜æ›´çš„æ–¹æ³•å®‰è£… Komposeã€‚</description>
    </item>
    
  </channel>
</rss>